<!doctype html>
<html style='font-size:22px !important'>
<head>
<meta charset='UTF-8'><meta name='viewport' content='width=device-width initial-scale=1'>
<title>TStarBots</title><link href='https://fonts.loli.net/css?family=Open+Sans:400italic,700italic,700,400&subset=latin,latin-ext' rel='stylesheet' type='text/css' /><style type='text/css'>html {overflow-x: initial !important;}:root { --bg-color: #ffffff; --text-color: #333333; --select-text-bg-color: #B5D6FC; --select-text-font-color: auto; --monospace: "Lucida Console",Consolas,"Courier",monospace; }
html { font-size: 14px; background-color: var(--bg-color); color: var(--text-color); font-family: "Helvetica Neue", Helvetica, Arial, sans-serif; -webkit-font-smoothing: antialiased; }
body { margin: 0px; padding: 0px; height: auto; bottom: 0px; top: 0px; left: 0px; right: 0px; font-size: 1rem; line-height: 1.42857143; overflow-x: hidden; background-image: inherit; background-size: inherit; background-attachment: inherit; background-origin: inherit; background-clip: inherit; background-color: inherit; background-position: inherit inherit; background-repeat: inherit inherit; }
iframe { margin: auto; }
a.url { word-break: break-all; }
a:active, a:hover { outline: 0px; }
.in-text-selection, ::selection { text-shadow: none; background: var(--select-text-bg-color); color: var(--select-text-font-color); }
#write { margin: 0px auto; height: auto; width: inherit; word-break: normal; word-wrap: break-word; position: relative; white-space: normal; overflow-x: visible; }
#write.first-line-indent p { text-indent: 2em; }
#write.first-line-indent li p, #write.first-line-indent p * { text-indent: 0px; }
#write.first-line-indent li { margin-left: 2em; }
.for-image #write { padding-left: 8px; padding-right: 8px; }
body.typora-export { padding-left: 30px; padding-right: 30px; }
.typora-export .footnote-line, .typora-export p { white-space: pre-wrap; }
@media screen and (max-width: 500px) { 
  body.typora-export { padding-left: 0px; padding-right: 0px; }
  .CodeMirror-sizer { margin-left: 0px !important; }
  .CodeMirror-gutters { display: none !important; }
}
#write li > figure:first-child { margin-top: -20px; }
#write ol, #write ul { position: relative; }
img { max-width: 100%; vertical-align: middle; }
button, input, select, textarea { color: inherit; font-family: inherit; font-size: inherit; font-style: inherit; font-variant-caps: inherit; font-weight: inherit; font-stretch: inherit; line-height: inherit; }
input[type="checkbox"], input[type="radio"] { line-height: normal; padding: 0px; }
*, ::after, ::before { box-sizing: border-box; }
#write h1, #write h2, #write h3, #write h4, #write h5, #write h6, #write p, #write pre { width: inherit; }
#write h1, #write h2, #write h3, #write h4, #write h5, #write h6, #write p { position: relative; }
h1, h2, h3, h4, h5, h6 { break-after: avoid-page; break-inside: avoid; orphans: 2; }
p { orphans: 4; }
h1 { font-size: 2rem; }
h2 { font-size: 1.8rem; }
h3 { font-size: 1.6rem; }
h4 { font-size: 1.4rem; }
h5 { font-size: 1.2rem; }
h6 { font-size: 1rem; }
.md-math-block, .md-rawblock, h1, h2, h3, h4, h5, h6, p { margin-top: 1rem; margin-bottom: 1rem; }
.hidden { display: none; }
.md-blockmeta { color: rgb(204, 204, 204); font-weight: 700; font-style: italic; }
a { cursor: pointer; }
sup.md-footnote { padding: 2px 4px; background-color: rgba(238, 238, 238, 0.701961); color: rgb(85, 85, 85); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; cursor: pointer; }
sup.md-footnote a, sup.md-footnote a:hover { color: inherit; text-transform: inherit; text-decoration: inherit; }
#write input[type="checkbox"] { cursor: pointer; width: inherit; height: inherit; }
figure { overflow-x: auto; margin: 1.2em 0px; max-width: calc(100% + 16px); padding: 0px; }
figure > table { margin: 0px !important; }
tr { break-inside: avoid; break-after: auto; }
thead { display: table-header-group; }
table { border-collapse: collapse; border-spacing: 0px; width: 100%; overflow: auto; break-inside: auto; text-align: left; }
table.md-table td { min-width: 80px; }
.CodeMirror-gutters { border-right-width: 0px; background-color: inherit; }
.CodeMirror { text-align: left; }
.CodeMirror-placeholder { opacity: 0.3; }
.CodeMirror pre { padding: 0px 4px; }
.CodeMirror-lines { padding: 0px; }
div.hr:focus { cursor: none; }
#write pre { white-space: pre-wrap; }
#write.fences-no-line-wrapping pre { white-space: pre; }
#write pre.ty-contain-cm { white-space: normal; }
.CodeMirror-gutters { margin-right: 4px; }
.md-fences { font-size: 0.9rem; display: block; break-inside: avoid; text-align: left; overflow: visible; white-space: pre; background-image: inherit; background-size: inherit; background-attachment: inherit; background-origin: inherit; background-clip: inherit; background-color: inherit; position: relative !important; background-position: inherit inherit; background-repeat: inherit inherit; }
.md-diagram-panel { width: 100%; margin-top: 10px; text-align: center; padding-top: 0px; padding-bottom: 8px; overflow-x: auto; }
#write .md-fences.mock-cm { white-space: pre-wrap; }
.md-fences.md-fences-with-lineno { padding-left: 0px; }
#write.fences-no-line-wrapping .md-fences.mock-cm { white-space: pre; overflow-x: auto; }
.md-fences.mock-cm.md-fences-with-lineno { padding-left: 8px; }
.CodeMirror-line, twitterwidget { break-inside: avoid; }
.footnotes { opacity: 0.8; font-size: 0.9rem; margin-top: 1em; margin-bottom: 1em; }
.footnotes + .footnotes { margin-top: 0px; }
.md-reset { margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: top; text-decoration: none; text-shadow: none; float: none; position: static; width: auto; height: auto; white-space: nowrap; cursor: inherit; line-height: normal; font-weight: 400; text-align: left; box-sizing: content-box; direction: ltr; background-position: 0px 0px; background-repeat: initial initial; }
li div { padding-top: 0px; }
blockquote { margin: 1rem 0px; }
li .mathjax-block, li p { margin: 0.5rem 0px; }
li { margin: 0px; position: relative; }
blockquote > :last-child { margin-bottom: 0px; }
blockquote > :first-child, li > :first-child { margin-top: 0px; }
.footnotes-area { color: rgb(136, 136, 136); margin-top: 0.714rem; padding-bottom: 0.143rem; white-space: normal; }
#write .footnote-line { white-space: pre-wrap; }
@media print { 
  body, html { border: 1px solid transparent; height: 99%; break-after: avoid-page; break-before: avoid-page; }
  #write { margin-top: 0px; border-color: transparent !important; }
  .typora-export * { -webkit-print-color-adjust: exact; }
  html.blink-to-pdf { font-size: 13px; }
  .typora-export #write { padding-left: 1cm; padding-right: 1cm; padding-bottom: 0px; break-after: avoid-page; }
  .typora-export #write::after { height: 0px; }
  @page { margin: 20mm 0px; }
}
.footnote-line { margin-top: 0.714em; font-size: 0.7em; }
a img, img a { cursor: pointer; }
pre.md-meta-block { font-size: 0.8rem; min-height: 0.8rem; white-space: pre-wrap; background-color: rgb(204, 204, 204); display: block; overflow-x: hidden; background-position: initial initial; background-repeat: initial initial; }
p > img:only-child { display: block; margin: auto; }
p > .md-image:only-child { display: inline-block; width: 100%; text-align: center; }
#write .MathJax_Display { margin: 0.8em 0px 0px; }
.md-math-block { width: 100%; }
.md-math-block:not(:empty)::after { display: none; }
[contenteditable="true"]:active, [contenteditable="true"]:focus { outline: 0px; box-shadow: none; }
.md-task-list-item { position: relative; list-style-type: none; }
.task-list-item.md-task-list-item { padding-left: 0px; }
.md-task-list-item > input { position: absolute; top: 0px; left: 0px; margin-left: -1.2em; margin-top: calc(1em - 10px); }
.math { font-size: 1rem; }
.md-toc { min-height: 3.58rem; position: relative; font-size: 0.9rem; border-top-left-radius: 10px; border-top-right-radius: 10px; border-bottom-right-radius: 10px; border-bottom-left-radius: 10px; }
.md-toc-content { position: relative; margin-left: 0px; }
.md-toc-content::after, .md-toc::after { display: none; }
.md-toc-item { display: block; color: rgb(65, 131, 196); }
.md-toc-item a { text-decoration: none; }
.md-toc-inner:hover { text-decoration: underline; }
.md-toc-inner { display: inline-block; cursor: pointer; }
.md-toc-h1 .md-toc-inner { margin-left: 0px; font-weight: 700; }
.md-toc-h2 .md-toc-inner { margin-left: 2em; }
.md-toc-h3 .md-toc-inner { margin-left: 4em; }
.md-toc-h4 .md-toc-inner { margin-left: 6em; }
.md-toc-h5 .md-toc-inner { margin-left: 8em; }
.md-toc-h6 .md-toc-inner { margin-left: 10em; }
@media screen and (max-width: 48em) { 
  .md-toc-h3 .md-toc-inner { margin-left: 3.5em; }
  .md-toc-h4 .md-toc-inner { margin-left: 5em; }
  .md-toc-h5 .md-toc-inner { margin-left: 6.5em; }
  .md-toc-h6 .md-toc-inner { margin-left: 8em; }
}
a.md-toc-inner { font-size: inherit; font-style: inherit; font-weight: inherit; line-height: inherit; }
.footnote-line a:not(.reversefootnote) { color: inherit; }
.md-attr { display: none; }
.md-fn-count::after { content: "."; }
code, pre, samp, tt { font-family: var(--monospace); }
kbd { margin: 0px 0.1em; padding: 0.1em 0.6em; font-size: 0.8em; color: rgb(36, 39, 41); background-color: rgb(255, 255, 255); border: 1px solid rgb(173, 179, 185); border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; box-shadow: rgba(12, 13, 14, 0.2) 0px 1px 0px, rgb(255, 255, 255) 0px 0px 0px 2px inset; white-space: nowrap; vertical-align: middle; background-position: initial initial; background-repeat: initial initial; }
.md-comment { color: rgb(162, 127, 3); opacity: 0.8; font-family: var(--monospace); }
code { text-align: left; }
a.md-print-anchor { white-space: pre !important; border: none !important; display: inline-block !important; position: absolute !important; width: 1px !important; right: 0px !important; outline: 0px !important; text-shadow: initial !important; background-position: 0px 0px !important; background-repeat: initial initial !important; }
.md-inline-math .MathJax_SVG .noError { display: none !important; }
.md-math-block .MathJax_SVG_Display { text-align: center; margin: 0px; position: relative; text-indent: 0px; max-width: none; max-height: none; min-height: 0px; min-width: 100%; width: auto; overflow-y: hidden; display: block !important; }
.MathJax_SVG_Display, .md-inline-math .MathJax_SVG_Display { width: auto; margin: inherit; display: inline-block !important; }
.MathJax_SVG .MJX-monospace { font-family: var(--monospace); }
.MathJax_SVG .MJX-sans-serif { font-family: sans-serif; }
.MathJax_SVG { display: inline; font-style: normal; font-weight: 400; line-height: normal; zoom: 90%; text-indent: 0px; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; }
.MathJax_SVG * { transition: none; }
.MathJax_SVG_Display svg { vertical-align: middle !important; margin-bottom: 0px !important; }
.os-windows.monocolor-emoji .md-emoji { font-family: "Segoe UI Symbol", sans-serif; }
.md-diagram-panel > svg { max-width: 100%; }
[lang="mermaid"] svg, [lang="flow"] svg { max-width: 100%; }
[lang="mermaid"] .node text { font-size: 1rem; }
table tr th { border-bottom-width: 0px; }
video { max-width: 100%; display: block; margin: 0px auto; }
iframe { max-width: 100%; width: 100%; border: none; }
.highlight td, .highlight tr { border: 0px; }


:root {
    --side-bar-bg-color: #fafafa;
    --control-text-color: #777;
}

@include-when-export url(https://fonts.loli.net/css?family=Open+Sans:400italic,700italic,700,400&subset=latin,latin-ext);

@font-face {
    font-family: 'Open Sans';
    font-style: normal;
    font-weight: normal;
    src: local('Open Sans Regular'),url('file:///Users/sinyeratlantis/Library/Application%20Support/abnerworks.Typora/themes/github/400.woff') format('woff');
}

@font-face {
    font-family: 'Open Sans';
    font-style: italic;
    font-weight: normal;
    src: local('Open Sans Italic'),url('file:///Users/sinyeratlantis/Library/Application%20Support/abnerworks.Typora/themes/github/400i.woff') format('woff');
}

@font-face {
    font-family: 'Open Sans';
    font-style: normal;
    font-weight: bold;
    src: local('Open Sans Bold'),url('file:///Users/sinyeratlantis/Library/Application%20Support/abnerworks.Typora/themes/github/700.woff') format('woff');
}

@font-face {
    font-family: 'Open Sans';
    font-style: italic;
    font-weight: bold;
    src: local('Open Sans Bold Italic'),url('file:///Users/sinyeratlantis/Library/Application%20Support/abnerworks.Typora/themes/github/700i.woff') format('woff');
}

html {
    font-size: 16px;
}

body {
    font-family: STKaiti, Times;
    color: rgb(51, 51, 51);
    line-height: 1.6;
}

#write {
    max-width: 860px;
  	margin: 0 auto;
  	padding: 30px;
    padding-bottom: 100px;
}
#write > ul:first-child,
#write > ol:first-child{
    margin-top: 30px;
}

a {
    color: #4183C4;
}
h1,
h2,
h3,
h4,
h5,
h6 {
    position: relative;
    margin-top: 1rem;
    margin-bottom: 1rem;
    font-weight: bold;
    line-height: 1.4;
    cursor: text;
}
h1:hover a.anchor,
h2:hover a.anchor,
h3:hover a.anchor,
h4:hover a.anchor,
h5:hover a.anchor,
h6:hover a.anchor {
    /*background: url("file:///Users/sinyeratlantis/Library/Application%20Support/images/modules/styleguide/para.png") no-repeat 10px center;*/
    text-decoration: none;
}
h1 tt,
h1 code {
    font-size: inherit;
}
h2 tt,
h2 code {
    font-size: inherit;
}
h3 tt,
h3 code {
    font-size: inherit;
}
h4 tt,
h4 code {
    font-size: inherit;
}
h5 tt,
h5 code {
    font-size: inherit;
}
h6 tt,
h6 code {
    font-size: inherit;
}
h1 {
    padding-bottom: .3em;
    font-size: 2.25em;
    line-height: 1.2;
    border-bottom: 1px solid #eee;
}
h2 {
   padding-bottom: .3em;
    font-size: 1.75em;
    line-height: 1.225;
    border-bottom: 1px solid #eee;
}
h3 {
    font-size: 1.5em;
    line-height: 1.43;
}
h4 {
    font-size: 1.25em;
}
h5 {
    font-size: 1em;
}
h6 {
   font-size: 1em;
    color: #777;
}
p,
blockquote,
ul,
ol,
dl,
table{
    margin: 0.8em 0;
}
li>ol,
li>ul {
    margin: 0 0;
}
hr {
    height: 2px;
    padding: 0;
    margin: 16px 0;
    background-color: #e7e7e7;
    border: 0 none;
    overflow: hidden;
    box-sizing: content-box;
}

li p.first {
    display: inline-block;
}
ul,
ol {
    padding-left: 30px;
}
ul:first-child,
ol:first-child {
    margin-top: 0;
}
ul:last-child,
ol:last-child {
    margin-bottom: 0;
}
blockquote {
    border-left: 4px solid #dfe2e5;
    padding: 0 15px;
    color: #777777;
}
blockquote blockquote {
    padding-right: 0;
}
table {
    padding: 0;
    word-break: initial;
}
table tr {
    border-top: 1px solid #dfe2e5;
    margin: 0;
    padding: 0;
}
table tr:nth-child(2n),
thead {
    background-color: #f8f8f8;
}
table tr th {
    font-weight: bold;
    border: 1px solid #dfe2e5;
    border-bottom: 0;
    text-align: left;
    margin: 0;
    padding: 6px 13px;
}
table tr td {
    border: 1px solid #dfe2e5;
    text-align: left;
    margin: 0;
    padding: 6px 13px;
}
table tr th:first-child,
table tr td:first-child {
    margin-top: 0;
}
table tr th:last-child,
table tr td:last-child {
    margin-bottom: 0;
}

.CodeMirror-lines {
    padding-left: 4px;
}

.code-tooltip {
    box-shadow: 0 1px 1px 0 rgba(0,28,36,.3);
    border-top: 1px solid #eef2f2;
}

.md-fences,
code,
tt {
    border: 1px solid #e7eaed;
    background-color: #f8f8f8;
    border-radius: 3px;
    padding: 0;
    padding: 2px 4px 0px 4px;
    font-size: 16px;
}

code {
    background-color: #f3f4f4;
    padding: 0 4px 2px 4px;
}

.md-fences {
    margin-bottom: 15px;
    margin-top: 15px;
    padding: 0.2em 1em;
    padding-top: 8px;
    padding-bottom: 6px;
}


.md-task-list-item > input {
  margin-left: -1.3em;
}

@media print {
    html {
        font-size: 13px;
    }
    table,
    pre {
        page-break-inside: avoid;
    }
    pre {
        word-wrap: break-word;
    }
}

.md-fences {
	background-color: #f8f8f8;
}
#write pre.md-meta-block {
	padding: 1rem;
    font-size: 85%;
    line-height: 1.45;
    background-color: #f7f7f7;
    border: 0;
    border-radius: 3px;
    color: #777777;
    margin-top: 0 !important;
}

.mathjax-block>.code-tooltip {
	bottom: .375rem;
}

.md-mathjax-midline {
    background: #fafafa;
}

#write>h3.md-focus:before{
	left: -1.5625rem;
	top: .375rem;
}
#write>h4.md-focus:before{
	left: -1.5625rem;
	top: .285714286rem;
}
#write>h5.md-focus:before{
	left: -1.5625rem;
	top: .285714286rem;
}
#write>h6.md-focus:before{
	left: -1.5625rem;
	top: .285714286rem;
}
.md-image>.md-meta {
    /*border: 1px solid #ddd;*/
    border-radius: 3px;
    padding: 2px 0px 0px 4px;
    font-size: 0.9em;
    color: inherit;
}

.md-tag {
    color: #a7a7a7;
    opacity: 1;
}

.md-toc { 
    margin-top:20px;
    padding-bottom:20px;
}

.sidebar-tabs {
    border-bottom: none;
}

#typora-quick-open {
    border: 1px solid #ddd;
    background-color: #f8f8f8;
}

#typora-quick-open-item {
    background-color: #FAFAFA;
    border-color: #FEFEFE #e5e5e5 #e5e5e5 #eee;
    border-style: solid;
    border-width: 1px;
}

/** focus mode */
.on-focus-mode blockquote {
    border-left-color: rgba(85, 85, 85, 0.12);
}

header, .context-menu, .megamenu-content, footer{
    font-family: "Segoe UI", "Arial", sans-serif;
}

.file-node-content:hover .file-node-icon,
.file-node-content:hover .file-node-open-state{
    visibility: visible;
}

.mac-seamless-mode #typora-sidebar {
    background-color: #fafafa;
    background-color: var(--side-bar-bg-color);
}

.md-lang {
    color: #b4654d;
}

.html-for-mac .context-menu {
    --item-hover-bg-color: #E6F0FE;
}

#md-notification .btn {
    border: 0;
}

.dropdown-menu .divider {
    border-color: #e5e5e5;
}

 .typora-export p, .typora-export .footnote-line {white-space: normal;} 
</style>
</head>
<body class='typora-export' >
<div  id='write'  class = 'is-mac'><h1><a name='header-n1511' class='md-header-anchor '></a>TStarBots：在完整游戏中击败星际争霸II的作弊等级</h1><p>TStarBots: Defeating the Cheating Level Builtin AI in StarCraft II in the Full Game</p><p>Peng Sun - Tencent AI Lab</p><h2><a name='header-n1515' class='md-header-anchor '></a>摘要</h2><p>星际争霸II（SC2）被广泛认为是最具挑战性的实时战略（RTS）游戏。潜在的挑战包括一个大的观察空间、一个巨大的（连续的和无限的）动作空间、部分观察、所有玩家的同步移动、以及局部决策的长期延迟奖励。为了推动人工智能研究的前沿，Deepmind和Blizzard联合开发了星际争霸II学习环境（SC2LE）作为复杂决策系统的测试平台。SC2LE提供了一些迷你游戏，如Move-To-Beacon、Collect-Mineral-Shards、和Defeat-Roaches，其中一些AI代理已达到人类职业玩家的性能水平。然而，对于完整的游戏，目前的AI代理仍远未达到人类专业级别的表现。为了弥补这一差距，我们在本文中提出了两个完整的游戏AI代理。 AI代理TStarBot1基于对平面动作结构的深度强化学习，而AI代理TStarBot2基于分层动作结构上的硬编码规则。 TStarBot1和TStarBot2都能够在完整游戏中击败内置AI代理从1级到10级（AbyssalReef地图上的1v1 Zerg-vs-Zerg游戏），注意到8级、9级和10级都是具有不公平优势的作弊代理，例如整个地图上的全视觉和资源丰富提升。据我们所知，这是第一个调查可以在星际争霸II完整游戏中击败内置AI的AI代理的公开工作。</p><h2><a name='header-n1517' class='md-header-anchor '></a>1. 介绍</h2><p>最近，深度学习和强化学习的结合导致基于机器的决策系统的重大突破，特别是对于计算机游戏。 基于深度强化学习的系统，无论是从头开始训练还是从预先训练的模型进行训练，都可以获取原始观察特征的输入并在广泛的应用中实现令人印象深刻的性能，包括棋盘游戏围棋、视频游戏（例如，Atari、第一人称射击游戏Doom和ViZDoom、Quake和DeepmindLab、Dota 2）、机器人视觉运动控制、机器人导航等。学习的策略或控制器可以令人惊讶地工作，并且在许多情况下甚至可以实现超人类性能。</p><p>然而，被广泛认为是最具挑战性的RTS游戏的星际争霸II仍然没有得到解决。在SC2中，人类玩家必须操纵数十到数百个单位用于多种目的，例如，收集两种类型的资源、扩展额外资源、升级技术、建立其他单位、派遣小队进行攻击或防御、对每个单位执行微观管理。Dota 2需要控制的单位总数最多为5（分别由5名玩家操纵），这是为什么SC2比Dota 2更具挑战性的一个重要的因素。图1显示了人类玩家使用的截图。对手的单位对玩家隐藏，除非他们处于由玩家控制的单位的观看范围内。玩家需要派出侦察部队来监视对手的战略。所有决定都必须实时做出。在设计AI代理方面，SC2涉及大型观察空间、巨大的动作空间、部分观察、所有玩家的同步移动以及本地决策的长期延迟奖励。所有这些因素都使SC2极具挑战性。为了推动人工智能研究的前沿，Deepmind和Blizzard联合开发了星际争霸II学习环境。 Deepmind最近的一些结果显示，他们的AI代理可以在一些迷你游戏中达到专业玩家的性能水平，例如，代理操纵海军陆战队员到达一个灯塔（MoveToBeacon）或操纵几个海军陆战队击败几个蟑螂（DefeatRoaches）等等。然而，对于完整的游戏，目前的AI代理仍远未达到人类专业级别的表现。</p><p>本文研究完整游戏的AI代理，为简单起见，我们将研究限制在以下设置：AbyssalReef地图上的1vs1 Zerg-vs-Zerg。 我们开发了两个AI代理：AI代理TStarBot1基于对平面操作的深度强化学习，而AI代理TStarBot2基于分层操作的规则控制器。 TStarBot1和TStarBot2都能够在完整游戏中击败内置AI代理从1级到10级，注意8级、9级和10级是作弊代理，具有不公平的优势，例如整个地图上的完整视觉和更丰富的资源。 值得一提的是，根据星际争霸II论坛的一些非正式讨论，10级内置人工智能估计是白金级钻石，相当于在战网的排名系统中前50％到30％的人类参与者。</p><p>AI代理TStarBot1基于“平面”动作建模，它采用平面动作结构并产生许多离散动作。这种设计使其能够立即用于任何采用离散动作作为输入的现成RL算法。 AI代理TStarBot2基于“深度”动作建模，它采用手动指定的动作层次结构。直观地说，“深度”建模可以更好地捕获动作依赖性。然而，由于需要用复杂分层RL的学习方法，因此训练变得更具挑战性。为了避免这个困难，我们在这项工作中简单地为TStarBot2采用了一个基于规则的控制器。</p><p>据我们所知，这是第一个调查可以在Starcraft II完整游戏中击败内置AI的AI代理的公开工作。代码将是开源的。我们希望所提出的框架将以几种可能的方式对未来的研究有益：</p><ol start='' ><li>成为混合系统的基线，其中可以包括越来越多的学习模块，而规则仍被用来表达难以学习的逻辑</li><li>为模仿学习生成轨迹</li><li>成为自我训练的对手</li></ol><h2><a name='header-n1530' class='md-header-anchor '></a>2. 相关工作</h2><p>RTS游戏星际争霸I多年来一直被用作人工智能研究的平台。  但是，大多数研究都认为搜索算法或多代理算法无法直接应用于完整游戏。 例如，已经提出许多多智能体强化学习算法来独立地或与通信联合来学习代理以执行协作任务，其中星际争霸单元（例如，海军陆战队、狂热者、小狗等）被视为代理。 这些方法只能处理迷你游戏，这应该被视为完整游戏的片段。</p><p>在SC2LE中尝试使用基于香草A3C的代理进行完整游戏，但报告的性能相对较差。 最近，提出了使用玩家级建模来攻克SC2游戏的关系神经网络。 然而，研究是在迷你游戏而不是完整游戏上进行的。</p><p>历史上，一些基于规则的决策系统在特定领域已经成功，例如，用于医学诊断的MYCIN或用于分子发现的DENTRAL。他们可以改进的唯一方法是手动添加知识，这使他们缺乏从数据中学习或与环境交互的能力。</p><p>基于规则的AI-bot在视频游戏行业中很受欢迎。然而，重点是开发用于代码重用的工具（例如，有限状态机或行为树），而不是如何将规则与基于学习的方法组合。最近的工作试图在行为树上执行强化学习或进化算法。但是，观察结果是表格式的，对SC2这样的大型游戏来说是不现实的。</p><p>我们的基于宏动作的代理（第3.2节）类似于[30]，其中作者采用宏观行动来定制迷你RTS游戏。但是，我们的宏操作集要大得多。它编写了执行的具体规则，因此对SC2LE更为现实。</p><p>在3.3节中，我们描述了基于层次动作的代理的实现。 我们的方法受到UAlbertaBot的模块化设计的启发，这在星际争霸I的文献中也被广泛采用。在精神上，层次动作集类似于FeUdal网络，但我们不追求完整层次结构的端到端学习。我们还允许每个行动都有自己的观察和策略。 这有助于系统排除噪声信息，如[32]中所述。</p><h2><a name='header-n1537' class='md-header-anchor '></a>3. 拟议的TStarBot代理</h2><p>在SC2的多重挑战中，这项工作主要集中在如何处理巨大的动作空间，我们认为这些动作空间源于游戏的复杂内在结构。 具体而言，有几个方面。</p><h5><a name='header-n1539' class='md-header-anchor '></a>分层特性</h5><p>在RTS游戏中，长期决策过程需要复杂的分层操作。人类玩家经常在几个抽象级别中总结他或她的思想，包括全局策略、本地策略和微型执行。如果学习算法不知道更高的“抽象级别”（即动作层次）并且直接在完整游戏中大量的基本原子动作上工作，则RL训练难免难以进行，特别是勘探的效率低下。例如，PySC2定义了低级人类用户界面上的动作空间，涉及屏幕坐标上的数百个热键和数千次鼠标点击。按照这种设置，即使是最先进的RL算法也只能在玩玩具迷你游戏方面取得成功，玩具迷你游戏的范围比整个游戏要短得多。虽然许多论文致力于在马尔可夫决策过程中自动学习有意义的层次结构，但这些方法都不能在像SC2那样复杂的环境中有效地工作。因此，利用决策过程的分层性质，并通过可管理的勘探工作来定义易处理的决策空间是一项具有挑战性的任务。</p><h5><a name='header-n1541' class='md-header-anchor '></a>SC2中的困难规则难以学习</h5><p>基于学习的代理设计的另一个挑战是RTS游戏中的大量“硬规则”。 这些硬性规则可被视为不可违反的“物理定律”。 它们很容易通过游戏中的文本指令被人类玩家解释，但是使用纯粹的试错方法学习算法很难发现。 考虑一个开始玩星际争霸II的人类玩家，他或她可以轻松地从文本教程中学习，首先选择一个Drone单元来构建一个RoachWarren单元，然后再选择一个Larva单元来制作一个Roach单元。 通过这样做，他或她可以快速发现以下硬游戏规则：</p><ul><li>RoachWarren是制作Roach（蟑螂）的先决条件</li><li>RoachWarren由Drone（雄蜂）构建</li><li>Roach是由Larva（幼虫）产生的</li><li>生产Roach需要75种矿物质和25种气体</li><li>。。。</li></ul><p>在SC2中，存在数千个这样的依赖关系，构成技术依赖树，缩写为TechTree（另请参见第3.1节）。 TechTree是人类玩家应该从游戏界面上的文本教程或材料中学习的最重要的先验知识，而不是通过反复试验进行探索。 不了解TechTree的学习算法必须花费大量时间来学习硬游戏规则，这会带来额外的困难，特别是当反馈信号稀疏和延迟时（即每场比赛结束时收到的赢/输奖励）。 因此，在RTS游戏中，重要的是要考虑如何设计一种机制，将这些硬游戏规则直接编码到代理的先验知识中，而不是依赖于纯粹的学习。</p><h5><a name='header-n1555' class='md-header-anchor '></a>对微不足道的决策因素的不经济学习</h5><p>值得注意的是，尽管SC2有巨大的决策空间，但并非所有决策都很重要。 换句话说，相当多的决定是多余的，因为它们对游戏的最终结果的影响可以忽略不计。 例如，当一个人类玩家想要在游戏中建立一个RoachWarren时，他或她必须考虑至少三个决策因素：</p><ul><li>决策因素1：何时构建它？（重要）</li><li>决策因素2：哪个Drone构建它？ （不重要）</li><li>决策因素3：在哪里建造它？ （不重要）</li></ul><p>一个熟练的玩家会得出结论：</p><ol start='' ><li>第一个决定因素是一个重要的因素，因为建立一个RoachWarren将对整个游戏进程产生相当大的影响</li><li>第二个决定是微不足道的，因为任何随机的Drone都可以在建筑效率差异微不足道的情况下完成工作</li><li>只要目标位置离自身基地不太远并且不考虑几何防御，第三因子也可以视为微不足道。 </li></ol><p>不了解这些因素的学习算法可能会花费大量精力来过滤掉琐碎的决定。 例如，“在哪里建造”的准确放置决定需要在数千个2D坐标中进行选择。 因此，为这些微不足道的因素投入太多的学习资源是不经济的。</p><p>为了应对这些挑战，我们建议使用手动调整的规则对行动结构进行建模。 通过这样做，可用的动作被简化为易处理的宏动作，并且整个决策系统的控制器更容易设计。 沿着这条思路，我们实施了两个AI代理。 一个代理采用基于强化学习的控制器而不是预定义的宏动作（第3.2节），而另一个代理采用具有基于规则的控制器的宏-微层次动作空间（第3.3节）。 执行动作依赖于SC2游戏的每单元控制接口，该接口在我们的PySC2扩展（第3.1节）中实现。</p><h3><a name='header-n1574' class='md-header-anchor '></a>3.1 我们的PySC2扩展</h3><p>SC2LE是由DeepMind和Blizzard联合开发的平台。 暴雪提供的游戏核心库提供了一个原始界面和一个功能图界面。 DeepMind PySC2环境进一步用Python包装核心库并完全公开特征映射接口。 目的是密切模仿人类控制（例如，鼠标点击或按下某些键盘按钮），由于SC2的复杂性，这引入了大量动作。 因此，它为基础决策系统带来了困难。 而且，这种“玩家级”建模对于设计“单元级”模型是不方便的，尤其是在考虑多个代理时。 在这项工作中，我们进一步努力公开单元级控制。 此外，我们将上述建筑依赖项编码为技术树。</p><h4><a name='header-n1576' class='md-header-anchor '></a>3.1.1 暴露单位控制</h4><p>在我们的PySC2扩展中，我们公开了SC2核心库的原始接口，它允许每单元观察和操作。 在每个游戏步骤中，可以检索玩家可见的所有单位（取决于是否启用了战争迷雾）。 每个单元都由属性列表完整描述，包括诸如位置和健康等属性。这样的原始单元阵列是返回给代理的观察的一部分。 同时，允许每单位动作控制每个单元。 代理可以向感兴趣的各个单元发送原始动作命令（例如，将单元移动到某个地方，或者要求单元攻击另一个单元等）。 可以在SC2核心库的protobuf中找到单元和每单元操作的定义。</p><h4><a name='header-n1578' class='md-header-anchor '></a>3.1.2 编码技术树</h4><p>在星际争霸II中，玩家可能需要特定单位（或建筑物或技术人员）作为其他先进单位（或建筑物或技术人员）的先决条件。 在UAlbertaBot之后，我们将这些依赖关系形式化为技术树，在我们的PySC2扩展中缩写为TechTree。 我们为Zerg收集了完整的TechTree，它为每个Zerg装置提供了成本、建造时间、建造能力、建造者和先决条件。 </p><p>除了上面描述的两个附加功能外，我们的PySC2扩展与原始的Deepmind PySC2完全兼容。</p><h3><a name='header-n1581' class='md-header-anchor '></a>3.2 TStarBot1：基于宏动作的强化学习代理</h3><p>我们在图2中说明了代理如何工作。在顶部，有一个单独的全局控制器，它将由RL学习，并且它会对暴露给它的宏操作做出决策。在底部，存在一系列宏动作，其硬编码游戏规则的先验知识（例如TechTree）以及如何执行动作（例如，哪个Drone构建以及在何处构建建筑动作）。因此，它隐藏了微不足道的决策因素并从顶级控制器执行细节。</p><p><img src='pic/tencent-f2.png' alt='' referrerPolicy='no-referrer' /></p><p>图2：基于宏观行动和强化学习的代理概述。 在顶部：一个可学习的控制器，从底部暴露的宏动作。在底部：165个可执行宏操作的池，其硬编码游戏规则的先验知识（例如TechTree）并隐藏琐碎的决策因素（例如建筑物放置）和来自顶层控制器的一些执行细节。 该图还说明了两个宏操作的定义，例如：BuildRoachWarren和ZoneAAttackZoneI。</p><p>通过这种架构，我们可以减轻底层学习算法直接处理大量原子操作的沉重负担，同时仍然保留了整个游戏宏观策略的大部分关键决策灵活性。而且，这样的代理可以配备硬游戏规则的基本知识而无需学习。通过这种充满先验知识的动作空间的抽象，代理可以在一个GPU的训练后1到2天内从头开始快速学习并击败最困难的内置机器人。以下小节提供了更多详细信息。</p><h4><a name='header-n1586' class='md-header-anchor '></a>3.2.1 宏观行动</h4><p>我们为Zerg-vs-Zerg SC2完整游戏设计了165个宏动作，如表1所示（完整列表请参阅附录-I）。 如上所述，宏操作的目的有两个：</p><ol start='' ><li>仅使用试错法对游戏的内在规则进行编码，这些规则难以学习。</li><li>通过硬编码决策隐藏学习算法中的琐碎决策。</li></ol><p>每个宏动作执行有意义的基本任务，例如，构建某个建筑物、产生某个单元、升级某种技术、收获某种资源、攻击某个地方等。因此它由一个构成或一系列原子操作组成。 通过动作空间中的这种抽象，学习完整游戏的高级策略变得更容易。 表1中说明了宏动作的一些示例。</p><p><img src='pic/tencent-t1.png' alt='' referrerPolicy='no-referrer' /></p><p>表1：165项宏观行动摘要：其类别、示例和硬编码的规则或知识。 在最右边的专栏中，TechTree已在3.1中解释过，RandUnit是指随机选择一个子单元，RandPlacer是指随机选择有效的放置坐标。</p><h5><a name='header-n1596' class='md-header-anchor '></a>建筑行为：</h5><p>建筑物是SC2进一步单元生产和技术升级的先决条件。建筑类别包含13个宏操作，每个宏操作在执行时构建一个Zerg。例如，宏操作BuildSpawningPool构建一个SpawningPool单元，其中包含一系列原子ui-actions：</p><ol start='' ><li>move_camera到基地</li><li>screen_point_select一个Drone（子单元）</li><li>在屏幕的某处build_spawningpool</li></ol><p>一系列原子操作有两个内部决策：</p><ol start='' ><li>Drone用于构建它？ </li><li>在哪里建造它？</li></ol><p>由于这两个决定通常对整个游戏过程影响不大，我们采用随机和基于规则的决策，即随机Drone选择器和随机空间布局器。随机空间布局器必须编码基本放置规则，如：虫族建筑物只能放置在蠕变区域，孵化场必须位于矿物附近，以获得公平的收获效率。此外，TechTree规则（例如“只有Drone可以构建SpawningPool”）也在此宏操作中编码。</p><h5><a name='header-n1612' class='md-header-anchor '></a>生产和技术升级行为：</h5><p>单位生产和技术升级在很大程度上决定了游戏中的经济和技术发展。 生产和技术升级类别包含22个宏操作。 每个宏动作要么产生某种类型的单元，要么升级某种技术。 这些宏操作是硬编码的，类似于上面描述的构建操作，除了它们不需要空间布局器。</p><h5><a name='header-n1614' class='md-header-anchor '></a>资源收集行为：</h5><p>矿物、天然气和Larva（仅限虫族）是SC2游戏中的三个关键资源。 它们的存储和收集速度可以极大地影响经济增长。 我们设计了3个相应的宏动作：CollectMinerals，CollectGas和InjectLarvas。 CollectMinerals和CollectGas将一定数量的随机工作人员（即Zerg-race中的Drone）分配给矿物碎片或气体提取器，这样，通过这两个宏观行为，工人可以重新分配到不同的任务，改变矿物和气体储存 （或它们的储存比例）以满足某些需求。 InjectLarvas只是命令所有空闲的皇后注入Larvas，这样可以加速单位生产过程。</p><h5><a name='header-n1616' class='md-header-anchor '></a>战斗行为：</h5><p>战斗行为设计是SC2 AI代理最重要的方面，直接影响游戏的结果。 我们精心设计了宏观行动来处理战斗策略的以下方面。</p><ul><li>攻击时间：例如，冲击、早期骚扰、最佳攻击时间窗口。</li><li>攻击路线：例如，在狭窄的斜坡上行走，这可能会限制攻击火力。</li><li>集合位置：例如，在攻击前集会以集中火力（注意各种单位可能有不同的移动速度）。</li></ul><p>我们通过区域宏观行动来表示这些战斗策略，其定义如下（也见图2）。 我们首先将整个世界地图划分为九个作战区域（名为Zone-A到Zone-I），并为整个世界划分另外一个Zone-J，共计10个区域。 根据区域，定义了100（= 10×10）个宏动作，每个宏动作执行如下规则：“如果有敌人，Zone-X中的战斗单位开始攻击Zone-Y，否则，返回到Zone-Y等一下”。 对于每个宏观行动中的微观攻击战术，我们只需对每个作战单位的“肇事逃逸”规则进行硬编码，即该单位向最近的敌人射击并在低生命值时逃跑。 我们将对微观战术的更复杂的多智能体学习的研究留给未来的工作。</p><p>通过这些宏观行动的构成，可以表现出各种各样的宏观战斗策略。 例如，攻击路线的选择可以由一系列区域性集中宏动作来表示。 通过这个定义，我们避免了复杂的多智能体学习的困难。</p><h5><a name='header-n1627' class='md-header-anchor '></a>可用的宏动作列表：</h5><p>并非每个上述预定义的宏操作都可以在任何时间步骤使用。 例如，TechTree中存在约束，表明某些单位/技术只能在某些条件下建造/生产/升级：例如，有足够的矿物/气体/食物储存或某些先决条件单位/技术的存在。 当不满足这些条件时，相应的宏动作应该是“什么都不做”。 我们在每个时间步都维护一个这样的可用宏操作列表，编码TechTree知识。 此可用操作列表会屏蔽每个时间步的无效操作。 该列表还可以用作机器学习的功能。</p><h4><a name='header-n1629' class='md-header-anchor '></a>3.2.2 观察和奖励</h4><p>观察结果表示为一组空间2D特征映射和一组非空间标量特征，从SC2游戏核心提供的每单位信息中提取，在我们的PySC2扩展中公开（参见第3.1节）。</p><h5><a name='header-n1631' class='md-header-anchor '></a>空间要素图</h5><p>提取的特征图的大小为N×N，其中N小于屏幕尺寸。 特征图的每个像素对应于整个世界地图中的小区域，表示某个统计量，例如该区域中某种类型的单位数。 这些数量包括玩家和对手常用单位类型的数量，以及具有某些属性的单位计数，例如“can-attack-ground”和“can-attack-air”。</p><h5><a name='header-n1633' class='md-header-anchor '></a>非空间特征</h5><p>标量特征包括收集的天然气和矿物质的数量、剩余的食物量、每种单位类型的数量等。它们还包括最近采取的跟踪过去信息的行动。</p><h5><a name='header-n1635' class='md-header-anchor '></a>奖励</h5><p>我们使用三元值奖励函数：在游戏结束时收到1（赢）/ 0（平局）/ -1（丢失）。 在比赛期间奖励总是为零。 尽管奖励信号非常稀疏，并且具有很长的时间范围延迟，但它仍然适用于本工作中提出的宏观行动结构。</p><h4><a name='header-n1637' class='md-header-anchor '></a>3.2.3 学习算法和神经网络架构</h4><p>基于上面定义的宏观动作和观察，问题变成顺序决策过程，其中宏动作空间具有易处理的大小并且游戏中的宏动作步骤的数量从原始原子动作的数量减少。</p><p>在时间步<span class="MathJax_Preview"></span><span class="MathJax_SVG" tabindex="-1" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.838ex" height="1.852ex" viewBox="0 -707.3 361 797.5" role="img" focusable="false" style="vertical-align: -0.209ex;"><defs><path stroke-width="0" id="E1-MJMATHI-74" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#E1-MJMATHI-74" x="0" y="0"></use></g></svg></span><script type="math/tex">t</script>，代理从游戏环境接收观察<span class="MathJax_Preview"></span><span class="MathJax_SVG" tabindex="-1" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.245ex" height="2.262ex" viewBox="0 -751.4 2688.8 973.8" role="img" focusable="false" style="vertical-align: -0.517ex;"><defs><path stroke-width="0" id="E2-MJMATHI-73" d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z"></path><path stroke-width="0" id="E2-MJMATHI-74" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path><path stroke-width="0" id="E2-MJMAIN-2208" d="M84 250Q84 372 166 450T360 539Q361 539 377 539T419 540T469 540H568Q583 532 583 520Q583 511 570 501L466 500Q355 499 329 494Q280 482 242 458T183 409T147 354T129 306T124 272V270H568Q583 262 583 250T568 230H124V228Q124 207 134 177T167 112T231 48T328 7Q355 1 466 0H570Q583 -10 583 -20Q583 -32 568 -40H471Q464 -40 446 -40T417 -41Q262 -41 172 45Q84 127 84 250Z"></path><path stroke-width="0" id="E2-MJCAL-53" d="M554 512Q536 512 536 522Q536 525 539 539T542 564Q542 588 528 604Q515 616 482 625T410 635Q374 635 349 624T312 594T295 561T290 532Q290 505 303 482T342 442T378 419T409 404Q435 391 451 383T494 357T535 323T562 282T574 231Q574 133 464 56T220 -22Q138 -22 78 21T18 123Q18 184 61 227T156 274Q178 274 178 263Q178 260 177 258Q172 247 164 239T151 227T136 218L127 213L124 202Q118 186 118 163Q120 124 165 86T292 48Q374 48 423 86T473 186V193Q473 267 347 327Q268 364 239 389Q191 431 191 486Q191 547 242 600T356 679T470 705Q472 705 478 705T489 704Q551 704 596 682T642 610Q642 566 621 545Q592 516 554 512Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#E2-MJMATHI-73" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#E2-MJMATHI-74" x="663" y="-213"></use><use xlink:href="#E2-MJMAIN-2208" x="1102" y="0"></use><use xlink:href="#E2-MJCAL-53" x="2046" y="0"></use></g></svg></span><script type="math/tex">s _ { t } \in \mathcal { S }</script>，并根据其策略<span class="MathJax_Preview"></span><span class="MathJax_SVG" tabindex="-1" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="8.139ex" height="2.671ex" viewBox="0 -839.6 3504.2 1150.2" role="img" focusable="false" style="vertical-align: -0.721ex;"><defs><path stroke-width="0" id="E3-MJMATHI-3C0" d="M132 -11Q98 -11 98 22V33L111 61Q186 219 220 334L228 358H196Q158 358 142 355T103 336Q92 329 81 318T62 297T53 285Q51 284 38 284Q19 284 19 294Q19 300 38 329T93 391T164 429Q171 431 389 431Q549 431 553 430Q573 423 573 402Q573 371 541 360Q535 358 472 358H408L405 341Q393 269 393 222Q393 170 402 129T421 65T431 37Q431 20 417 5T381 -10Q370 -10 363 -7T347 17T331 77Q330 86 330 121Q330 170 339 226T357 318T367 358H269L268 354Q268 351 249 275T206 114T175 17Q164 -11 132 -11Z"></path><path stroke-width="0" id="E3-MJMAIN-28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path><path stroke-width="0" id="E3-MJMATHI-61" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path><path stroke-width="0" id="E3-MJMATHI-74" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path><path stroke-width="0" id="E3-MJMAIN-7C" d="M139 -249H137Q125 -249 119 -235V251L120 737Q130 750 139 750Q152 750 159 735V-235Q151 -249 141 -249H139Z"></path><path stroke-width="0" id="E3-MJMATHI-73" d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z"></path><path stroke-width="0" id="E3-MJMAIN-29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#E3-MJMATHI-3C0" x="0" y="0"></use><g transform="translate(739,0)"><use xlink:href="#E3-MJMAIN-28" x="0" y="0"></use><g transform="translate(389,0)"><use xlink:href="#E3-MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#E3-MJMATHI-74" x="748" y="-213"></use></g><use xlink:href="#E3-MJMAIN-7C" x="1273" y="0"></use><g transform="translate(1551,0)"><use xlink:href="#E3-MJMATHI-73" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#E3-MJMATHI-74" x="663" y="-213"></use></g><use xlink:href="#E3-MJMAIN-29" x="2375" y="0"></use></g></g></svg></span><script type="math/tex">\pi \left( a _ { t } | s _ { t } \right)</script>（<span class="MathJax_Preview"></span><span class="MathJax_SVG" tabindex="-1" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.902ex" height="2.159ex" viewBox="0 -795.5 819 929.8" role="img" focusable="false" style="vertical-align: -0.312ex;"><defs><path stroke-width="0" id="E6-MJCAL-41" d="M576 668Q576 688 606 708T660 728Q676 728 675 712V571Q675 409 688 252Q696 122 720 57Q722 53 723 50T728 46T732 43T737 41T743 39L754 45Q788 61 803 61Q819 61 819 47Q818 43 814 35Q799 15 755 -7T675 -30Q659 -30 648 -25T630 -8T621 11T614 34Q603 77 599 106T594 146T591 160V163H460L329 164L316 145Q241 35 196 -7T119 -50T59 -24T30 43Q30 75 46 100T74 125Q81 125 83 120T88 104T96 84Q118 57 151 57Q189 57 277 182Q432 400 542 625L559 659H567Q574 659 575 660T576 668ZM584 249Q579 333 577 386T575 473T574 520V581L563 560Q497 426 412 290L372 228L370 224H371L383 228L393 232H586L584 249Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#E6-MJCAL-41" x="0" y="0"></use></g></svg></span><script type="math/tex">\mathcal { A }</script>上的条件概率分布）选择<span class="MathJax_Preview"></span><span class="MathJax_SVG" tabindex="-1" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.795ex" height="2.364ex" viewBox="0 -795.5 2925.8 1017.9" role="img" focusable="false" style="vertical-align: -0.517ex;"><defs><path stroke-width="0" id="E5-MJMATHI-61" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path><path stroke-width="0" id="E5-MJMATHI-74" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path><path stroke-width="0" id="E5-MJMAIN-2208" d="M84 250Q84 372 166 450T360 539Q361 539 377 539T419 540T469 540H568Q583 532 583 520Q583 511 570 501L466 500Q355 499 329 494Q280 482 242 458T183 409T147 354T129 306T124 272V270H568Q583 262 583 250T568 230H124V228Q124 207 134 177T167 112T231 48T328 7Q355 1 466 0H570Q583 -10 583 -20Q583 -32 568 -40H471Q464 -40 446 -40T417 -41Q262 -41 172 45Q84 127 84 250Z"></path><path stroke-width="0" id="E5-MJCAL-41" d="M576 668Q576 688 606 708T660 728Q676 728 675 712V571Q675 409 688 252Q696 122 720 57Q722 53 723 50T728 46T732 43T737 41T743 39L754 45Q788 61 803 61Q819 61 819 47Q818 43 814 35Q799 15 755 -7T675 -30Q659 -30 648 -25T630 -8T621 11T614 34Q603 77 599 106T594 146T591 160V163H460L329 164L316 145Q241 35 196 -7T119 -50T59 -24T30 43Q30 75 46 100T74 125Q81 125 83 120T88 104T96 84Q118 57 151 57Q189 57 277 182Q432 400 542 625L559 659H567Q574 659 575 660T576 668ZM584 249Q579 333 577 386T575 473T574 520V581L563 560Q497 426 412 290L372 228L370 224H371L383 228L393 232H586L584 249Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#E5-MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#E5-MJMATHI-74" x="748" y="-213"></use><use xlink:href="#E5-MJMAIN-2208" x="1162" y="0"></use><use xlink:href="#E5-MJCAL-41" x="2106" y="0"></use></g></svg></span><script type="math/tex">a _ { t } \in \mathcal { A }</script>的宏动作，其中<span class="MathJax_Preview"></span><span class="MathJax_SVG" tabindex="-1" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.902ex" height="2.159ex" viewBox="0 -795.5 819 929.8" role="img" focusable="false" style="vertical-align: -0.312ex;"><defs><path stroke-width="0" id="E6-MJCAL-41" d="M576 668Q576 688 606 708T660 728Q676 728 675 712V571Q675 409 688 252Q696 122 720 57Q722 53 723 50T728 46T732 43T737 41T743 39L754 45Q788 61 803 61Q819 61 819 47Q818 43 814 35Q799 15 755 -7T675 -30Q659 -30 648 -25T630 -8T621 11T614 34Q603 77 599 106T594 146T591 160V163H460L329 164L316 145Q241 35 196 -7T119 -50T59 -24T30 43Q30 75 46 100T74 125Q81 125 83 120T88 104T96 84Q118 57 151 57Q189 57 277 182Q432 400 542 625L559 659H567Q574 659 575 660T576 668ZM584 249Q579 333 577 386T575 473T574 520V581L563 560Q497 426 412 290L372 228L370 224H371L383 228L393 232H586L584 249Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#E6-MJCAL-41" x="0" y="0"></use></g></svg></span><script type="math/tex">\mathcal { A }</script>表示该组第3.2.1节中定义的宏操作。 然后，通过使用相应的手动调整规则，将所选择的宏动作转换为游戏核心可接受的原子动作序列。 在采取原子动作之后，代理接收到奖励<span class="MathJax_Preview"></span><span class="MathJax_SVG" tabindex="-1" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.873ex" height="1.75ex" viewBox="0 -531 806.3 753.4" role="img" focusable="false" style="vertical-align: -0.517ex;"><defs><path stroke-width="0" id="E7-MJMATHI-72" d="M21 287Q22 290 23 295T28 317T38 348T53 381T73 411T99 433T132 442Q161 442 183 430T214 408T225 388Q227 382 228 382T236 389Q284 441 347 441H350Q398 441 422 400Q430 381 430 363Q430 333 417 315T391 292T366 288Q346 288 334 299T322 328Q322 376 378 392Q356 405 342 405Q286 405 239 331Q229 315 224 298T190 165Q156 25 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 114 189T154 366Q154 405 128 405Q107 405 92 377T68 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path><path stroke-width="0" id="E7-MJMATHI-74" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#E7-MJMATHI-72" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#E7-MJMATHI-74" x="637" y="-213"></use></g></svg></span><script type="math/tex">r _ { t }</script>和下一步观察<span class="MathJax_Preview"></span><span class="MathJax_SVG" tabindex="-1" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.013ex" height="1.852ex" viewBox="0 -531 1727.9 797.5" role="img" focusable="false" style="vertical-align: -0.619ex;"><defs><path stroke-width="0" id="E8-MJMATHI-73" d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z"></path><path stroke-width="0" id="E8-MJMATHI-74" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path><path stroke-width="0" id="E8-MJMAIN-2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z"></path><path stroke-width="0" id="E8-MJMAIN-31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#E8-MJMATHI-73" x="0" y="0"></use><g transform="translate(469,-150)"><use transform="scale(0.707)" xlink:href="#E8-MJMATHI-74" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#E8-MJMAIN-2B" x="361" y="0"></use><use transform="scale(0.707)" xlink:href="#E8-MJMAIN-31" x="1139" y="0"></use></g></g></svg></span><script type="math/tex">s _ { t + 1 }</script>。 这个循环一直持续到游戏结束。</p><p>我们的目标是为代理学习最优策略<span class="MathJax_Preview"></span><span class="MathJax_SVG" tabindex="-1" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="9.194ex" height="2.671ex" viewBox="0 -839.6 3958.7 1150.2" role="img" focusable="false" style="vertical-align: -0.721ex;"><defs><path stroke-width="0" id="E9-MJMATHI-3C0" d="M132 -11Q98 -11 98 22V33L111 61Q186 219 220 334L228 358H196Q158 358 142 355T103 336Q92 329 81 318T62 297T53 285Q51 284 38 284Q19 284 19 294Q19 300 38 329T93 391T164 429Q171 431 389 431Q549 431 553 430Q573 423 573 402Q573 371 541 360Q535 358 472 358H408L405 341Q393 269 393 222Q393 170 402 129T421 65T431 37Q431 20 417 5T381 -10Q370 -10 363 -7T347 17T331 77Q330 86 330 121Q330 170 339 226T357 318T367 358H269L268 354Q268 351 249 275T206 114T175 17Q164 -11 132 -11Z"></path><path stroke-width="0" id="E9-MJMAIN-2217" d="M229 286Q216 420 216 436Q216 454 240 464Q241 464 245 464T251 465Q263 464 273 456T283 436Q283 419 277 356T270 286L328 328Q384 369 389 372T399 375Q412 375 423 365T435 338Q435 325 425 315Q420 312 357 282T289 250L355 219L425 184Q434 175 434 161Q434 146 425 136T401 125Q393 125 383 131T328 171L270 213Q283 79 283 63Q283 53 276 44T250 35Q231 35 224 44T216 63Q216 80 222 143T229 213L171 171Q115 130 110 127Q106 124 100 124Q87 124 76 134T64 161Q64 166 64 169T67 175T72 181T81 188T94 195T113 204T138 215T170 230T210 250L74 315Q65 324 65 338Q65 353 74 363T98 374Q106 374 116 368T171 328L229 286Z"></path><path stroke-width="0" id="E9-MJMAIN-28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path><path stroke-width="0" id="E9-MJMATHI-61" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path><path stroke-width="0" id="E9-MJMATHI-74" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path><path stroke-width="0" id="E9-MJMAIN-7C" d="M139 -249H137Q125 -249 119 -235V251L120 737Q130 750 139 750Q152 750 159 735V-235Q151 -249 141 -249H139Z"></path><path stroke-width="0" id="E9-MJMATHI-73" d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z"></path><path stroke-width="0" id="E9-MJMAIN-29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#E9-MJMATHI-3C0" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#E9-MJMAIN-2217" x="811" y="513"></use><g transform="translate(1194,0)"><use xlink:href="#E9-MJMAIN-28" x="0" y="0"></use><g transform="translate(389,0)"><use xlink:href="#E9-MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#E9-MJMATHI-74" x="748" y="-213"></use></g><use xlink:href="#E9-MJMAIN-7C" x="1273" y="0"></use><g transform="translate(1551,0)"><use xlink:href="#E9-MJMATHI-73" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#E9-MJMATHI-74" x="663" y="-213"></use></g><use xlink:href="#E9-MJMAIN-29" x="2375" y="0"></use></g></g></svg></span><script type="math/tex">\pi ^ { * } \left( a _ { t } | s _ { t } \right)</script>，以最大化其在未来所有步骤中的预期累积回报。 当我们直接使用第3.2.2节中定义的奖励函数而没有额外的奖励形成时，优化目标是等效的（当忽略奖励折扣时）以最大化代理的获胜概率。 我们训练我们的TStarBot1代理，通过使用现成的强化学习算法（例如Dueling-DDQN和PPO）与分布式部署基础设施进行内置AI竞争，从头学习这样的策略。 详情如下。</p><h5><a name='header-n1641' class='md-header-anchor '></a>决斗双深Q学习（DDQN）</h5><p>Deep Q Network首先学习最优状态-动作值函数（Q函数）的参数化估计<span class="MathJax_Preview"></span><span class="MathJax_SVG" tabindex="-1" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="8.73ex" height="3.081ex" viewBox="0 -1015.9 3758.7 1326.5" role="img" focusable="false" style="vertical-align: -0.721ex;"><defs><path stroke-width="0" id="E10-MJMATHI-51" d="M399 -80Q399 -47 400 -30T402 -11V-7L387 -11Q341 -22 303 -22Q208 -22 138 35T51 201Q50 209 50 244Q50 346 98 438T227 601Q351 704 476 704Q514 704 524 703Q621 689 680 617T740 435Q740 255 592 107Q529 47 461 16L444 8V3Q444 2 449 -24T470 -66T516 -82Q551 -82 583 -60T625 -3Q631 11 638 11Q647 11 649 2Q649 -6 639 -34T611 -100T557 -165T481 -194Q399 -194 399 -87V-80ZM636 468Q636 523 621 564T580 625T530 655T477 665Q429 665 379 640Q277 591 215 464T153 216Q153 110 207 59Q231 38 236 38V46Q236 86 269 120T347 155Q372 155 390 144T417 114T429 82T435 55L448 64Q512 108 557 185T619 334T636 468ZM314 18Q362 18 404 39L403 49Q399 104 366 115Q354 117 347 117Q344 117 341 117T337 118Q317 118 296 98T274 52Q274 18 314 18Z"></path><path stroke-width="0" id="E10-MJMAIN-5E" d="M112 560L249 694L257 686Q387 562 387 560L361 531Q359 532 303 581L250 627L195 580Q182 569 169 557T148 538L140 532Q138 530 125 546L112 560Z"></path><path stroke-width="0" id="E10-MJMAIN-28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path><path stroke-width="0" id="E10-MJMATHI-73" d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z"></path><path stroke-width="0" id="E10-MJMAIN-2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path><path stroke-width="0" id="E10-MJMATHI-61" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path><path stroke-width="0" id="E10-MJMAIN-7C" d="M139 -249H137Q125 -249 119 -235V251L120 737Q130 750 139 750Q152 750 159 735V-235Q151 -249 141 -249H139Z"></path><path stroke-width="0" id="E10-MJMATHI-3B8" d="M35 200Q35 302 74 415T180 610T319 704Q320 704 327 704T339 705Q393 701 423 656Q462 596 462 495Q462 380 417 261T302 66T168 -10H161Q125 -10 99 10T60 63T41 130T35 200ZM383 566Q383 668 330 668Q294 668 260 623T204 521T170 421T157 371Q206 370 254 370L351 371Q352 372 359 404T375 484T383 566ZM113 132Q113 26 166 26Q181 26 198 36T239 74T287 161T335 307L340 324H145Q145 321 136 286T120 208T113 132Z"></path><path stroke-width="0" id="E10-MJMAIN-29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#E10-MJMATHI-51" x="0" y="0"></use><use xlink:href="#E10-MJMAIN-5E" x="228" y="239"></use><use xlink:href="#E10-MJMAIN-28" x="791" y="0"></use><use xlink:href="#E10-MJMATHI-73" x="1180" y="0"></use><use xlink:href="#E10-MJMAIN-2C" x="1649" y="0"></use><use xlink:href="#E10-MJMATHI-61" x="2093" y="0"></use><use xlink:href="#E10-MJMAIN-7C" x="2622" y="0"></use><use xlink:href="#E10-MJMATHI-3B8" x="2900" y="0"></use><use xlink:href="#E10-MJMAIN-29" x="3369" y="0"></use></g></svg></span><script type="math/tex">\hat { Q } ( s , a | \theta )</script>，<span class="MathJax_Preview"></span><span class="MathJax_SVG" tabindex="-1" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="29.271ex" height="2.876ex" viewBox="0 -839.6 12602.8 1238.4" role="img" focusable="false" style="vertical-align: -0.926ex;"><defs><path stroke-width="0" id="E12-MJMATHI-51" d="M399 -80Q399 -47 400 -30T402 -11V-7L387 -11Q341 -22 303 -22Q208 -22 138 35T51 201Q50 209 50 244Q50 346 98 438T227 601Q351 704 476 704Q514 704 524 703Q621 689 680 617T740 435Q740 255 592 107Q529 47 461 16L444 8V3Q444 2 449 -24T470 -66T516 -82Q551 -82 583 -60T625 -3Q631 11 638 11Q647 11 649 2Q649 -6 639 -34T611 -100T557 -165T481 -194Q399 -194 399 -87V-80ZM636 468Q636 523 621 564T580 625T530 655T477 665Q429 665 379 640Q277 591 215 464T153 216Q153 110 207 59Q231 38 236 38V46Q236 86 269 120T347 155Q372 155 390 144T417 114T429 82T435 55L448 64Q512 108 557 185T619 334T636 468ZM314 18Q362 18 404 39L403 49Q399 104 366 115Q354 117 347 117Q344 117 341 117T337 118Q317 118 296 98T274 52Q274 18 314 18Z"></path><path stroke-width="0" id="E12-MJMAIN-2217" d="M229 286Q216 420 216 436Q216 454 240 464Q241 464 245 464T251 465Q263 464 273 456T283 436Q283 419 277 356T270 286L328 328Q384 369 389 372T399 375Q412 375 423 365T435 338Q435 325 425 315Q420 312 357 282T289 250L355 219L425 184Q434 175 434 161Q434 146 425 136T401 125Q393 125 383 131T328 171L270 213Q283 79 283 63Q283 53 276 44T250 35Q231 35 224 44T216 63Q216 80 222 143T229 213L171 171Q115 130 110 127Q106 124 100 124Q87 124 76 134T64 161Q64 166 64 169T67 175T72 181T81 188T94 195T113 204T138 215T170 230T210 250L74 315Q65 324 65 338Q65 353 74 363T98 374Q106 374 116 368T171 328L229 286Z"></path><path stroke-width="0" id="E12-MJMATHI-3B8" d="M35 200Q35 302 74 415T180 610T319 704Q320 704 327 704T339 705Q393 701 423 656Q462 596 462 495Q462 380 417 261T302 66T168 -10H161Q125 -10 99 10T60 63T41 130T35 200ZM383 566Q383 668 330 668Q294 668 260 623T204 521T170 421T157 371Q206 370 254 370L351 371Q352 372 359 404T375 484T383 566ZM113 132Q113 26 166 26Q181 26 198 36T239 74T287 161T335 307L340 324H145Q145 321 136 286T120 208T113 132Z"></path><path stroke-width="0" id="E12-MJMAIN-28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path><path stroke-width="0" id="E12-MJMATHI-73" d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z"></path><path stroke-width="0" id="E12-MJMATHI-74" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path><path stroke-width="0" id="E12-MJMAIN-2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path><path stroke-width="0" id="E12-MJMATHI-61" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path><path stroke-width="0" id="E12-MJMAIN-29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path><path stroke-width="0" id="E12-MJMAIN-3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path><path stroke-width="0" id="E12-MJMAIN-6D" d="M41 46H55Q94 46 102 60V68Q102 77 102 91T102 122T103 161T103 203Q103 234 103 269T102 328V351Q99 370 88 376T43 385H25V408Q25 431 27 431L37 432Q47 433 65 434T102 436Q119 437 138 438T167 441T178 442H181V402Q181 364 182 364T187 369T199 384T218 402T247 421T285 437Q305 442 336 442Q351 442 364 440T387 434T406 426T421 417T432 406T441 395T448 384T452 374T455 366L457 361L460 365Q463 369 466 373T475 384T488 397T503 410T523 422T546 432T572 439T603 442Q729 442 740 329Q741 322 741 190V104Q741 66 743 59T754 49Q775 46 803 46H819V0H811L788 1Q764 2 737 2T699 3Q596 3 587 0H579V46H595Q656 46 656 62Q657 64 657 200Q656 335 655 343Q649 371 635 385T611 402T585 404Q540 404 506 370Q479 343 472 315T464 232V168V108Q464 78 465 68T468 55T477 49Q498 46 526 46H542V0H534L510 1Q487 2 460 2T422 3Q319 3 310 0H302V46H318Q379 46 379 62Q380 64 380 200Q379 335 378 343Q372 371 358 385T334 402T308 404Q263 404 229 370Q202 343 195 315T187 232V168V108Q187 78 188 68T191 55T200 49Q221 46 249 46H265V0H257L234 1Q210 2 183 2T145 3Q42 3 33 0H25V46H41Z"></path><path stroke-width="0" id="E12-MJMAIN-61" d="M137 305T115 305T78 320T63 359Q63 394 97 421T218 448Q291 448 336 416T396 340Q401 326 401 309T402 194V124Q402 76 407 58T428 40Q443 40 448 56T453 109V145H493V106Q492 66 490 59Q481 29 455 12T400 -6T353 12T329 54V58L327 55Q325 52 322 49T314 40T302 29T287 17T269 6T247 -2T221 -8T190 -11Q130 -11 82 20T34 107Q34 128 41 147T68 188T116 225T194 253T304 268H318V290Q318 324 312 340Q290 411 215 411Q197 411 181 410T156 406T148 403Q170 388 170 359Q170 334 154 320ZM126 106Q126 75 150 51T209 26Q247 26 276 49T315 109Q317 116 318 175Q318 233 317 233Q309 233 296 232T251 223T193 203T147 166T126 106Z"></path><path stroke-width="0" id="E12-MJMAIN-78" d="M201 0Q189 3 102 3Q26 3 17 0H11V46H25Q48 47 67 52T96 61T121 78T139 96T160 122T180 150L226 210L168 288Q159 301 149 315T133 336T122 351T113 363T107 370T100 376T94 379T88 381T80 383Q74 383 44 385H16V431H23Q59 429 126 429Q219 429 229 431H237V385Q201 381 201 369Q201 367 211 353T239 315T268 274L272 270L297 304Q329 345 329 358Q329 364 327 369T322 376T317 380T310 384L307 385H302V431H309Q324 428 408 428Q487 428 493 431H499V385H492Q443 385 411 368Q394 360 377 341T312 257L296 236L358 151Q424 61 429 57T446 50Q464 46 499 46H516V0H510H502Q494 1 482 1T457 2T432 2T414 3Q403 3 377 3T327 1L304 0H295V46H298Q309 46 320 51T331 63Q331 65 291 120L250 175Q249 174 219 133T185 88Q181 83 181 74Q181 63 188 55T206 46Q208 46 208 23V0H201Z"></path><path stroke-width="0" id="E12-MJMATHI-3C0" d="M132 -11Q98 -11 98 22V33L111 61Q186 219 220 334L228 358H196Q158 358 142 355T103 336Q92 329 81 318T62 297T53 285Q51 284 38 284Q19 284 19 294Q19 300 38 329T93 391T164 429Q171 431 389 431Q549 431 553 430Q573 423 573 402Q573 371 541 360Q535 358 472 358H408L405 341Q393 269 393 222Q393 170 402 129T421 65T431 37Q431 20 417 5T381 -10Q370 -10 363 -7T347 17T331 77Q330 86 330 121Q330 170 339 226T357 318T367 358H269L268 354Q268 351 249 275T206 114T175 17Q164 -11 132 -11Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#E12-MJMATHI-51" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#E12-MJMAIN-2217" x="1118" y="452"></use><use transform="scale(0.707)" xlink:href="#E12-MJMATHI-3B8" x="1118" y="-473"></use><g transform="translate(1411,0)"><use xlink:href="#E12-MJMAIN-28" x="0" y="0"></use><g transform="translate(389,0)"><use xlink:href="#E12-MJMATHI-73" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#E12-MJMATHI-74" x="663" y="-213"></use></g><use xlink:href="#E12-MJMAIN-2C" x="1213" y="0"></use><g transform="translate(1657,0)"><use xlink:href="#E12-MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#E12-MJMATHI-74" x="748" y="-213"></use></g><use xlink:href="#E12-MJMAIN-29" x="2542" y="0"></use></g><use xlink:href="#E12-MJMAIN-3D" x="4620" y="0"></use><g transform="translate(5675,0)"><use xlink:href="#E12-MJMAIN-6D"></use><use xlink:href="#E12-MJMAIN-61" x="833" y="0"></use><use xlink:href="#E12-MJMAIN-78" x="1333" y="0"></use><use transform="scale(0.707)" xlink:href="#E12-MJMATHI-3C0" x="2631" y="-213"></use></g><g transform="translate(8208,0)"><use xlink:href="#E12-MJMATHI-51" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#E12-MJMATHI-3C0" x="1118" y="513"></use></g><g transform="translate(9671,0)"><use xlink:href="#E12-MJMAIN-28" x="0" y="0"></use><g transform="translate(389,0)"><use xlink:href="#E12-MJMATHI-73" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#E12-MJMATHI-74" x="663" y="-213"></use></g><use xlink:href="#E12-MJMAIN-2C" x="1213" y="0"></use><g transform="translate(1657,0)"><use xlink:href="#E12-MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#E12-MJMATHI-74" x="748" y="-213"></use></g><use xlink:href="#E12-MJMAIN-29" x="2542" y="0"></use></g></g></svg></span><script type="math/tex">Q _ { \theta } ^ { * } \left( s _ { t } , a _ { t } \right) = \max _ { \pi } Q ^ { \pi } \left( s _ { t } , a _ { t } \right)</script>，其中<span class="MathJax_Preview"></span><span class="MathJax_SVG" tabindex="-1" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="33.903ex" height="4.514ex" viewBox="0 -1236.4 14597 1943.7" role="img" focusable="false" style="vertical-align: -1.643ex;"><defs><path stroke-width="0" id="E13-MJMATHI-51" d="M399 -80Q399 -47 400 -30T402 -11V-7L387 -11Q341 -22 303 -22Q208 -22 138 35T51 201Q50 209 50 244Q50 346 98 438T227 601Q351 704 476 704Q514 704 524 703Q621 689 680 617T740 435Q740 255 592 107Q529 47 461 16L444 8V3Q444 2 449 -24T470 -66T516 -82Q551 -82 583 -60T625 -3Q631 11 638 11Q647 11 649 2Q649 -6 639 -34T611 -100T557 -165T481 -194Q399 -194 399 -87V-80ZM636 468Q636 523 621 564T580 625T530 655T477 665Q429 665 379 640Q277 591 215 464T153 216Q153 110 207 59Q231 38 236 38V46Q236 86 269 120T347 155Q372 155 390 144T417 114T429 82T435 55L448 64Q512 108 557 185T619 334T636 468ZM314 18Q362 18 404 39L403 49Q399 104 366 115Q354 117 347 117Q344 117 341 117T337 118Q317 118 296 98T274 52Q274 18 314 18Z"></path><path stroke-width="0" id="E13-MJMATHI-3C0" d="M132 -11Q98 -11 98 22V33L111 61Q186 219 220 334L228 358H196Q158 358 142 355T103 336Q92 329 81 318T62 297T53 285Q51 284 38 284Q19 284 19 294Q19 300 38 329T93 391T164 429Q171 431 389 431Q549 431 553 430Q573 423 573 402Q573 371 541 360Q535 358 472 358H408L405 341Q393 269 393 222Q393 170 402 129T421 65T431 37Q431 20 417 5T381 -10Q370 -10 363 -7T347 17T331 77Q330 86 330 121Q330 170 339 226T357 318T367 358H269L268 354Q268 351 249 275T206 114T175 17Q164 -11 132 -11Z"></path><path stroke-width="0" id="E13-MJMAIN-28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path><path stroke-width="0" id="E13-MJMATHI-73" d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z"></path><path stroke-width="0" id="E13-MJMATHI-74" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path><path stroke-width="0" id="E13-MJMAIN-2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path><path stroke-width="0" id="E13-MJMATHI-61" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path><path stroke-width="0" id="E13-MJMAIN-29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path><path stroke-width="0" id="E13-MJMAIN-3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path><path stroke-width="0" id="E13-MJAMS-45" d="M12 666Q12 675 24 683H582Q590 680 593 672V588Q593 514 591 502T575 490Q567 490 563 495T555 517Q552 556 517 590Q486 623 445 634T340 648H282Q266 636 264 620T260 492V370H277Q329 375 358 391T404 439Q420 480 420 506Q420 529 436 529Q445 529 451 521Q455 517 455 361Q455 333 455 298T456 253Q456 217 453 207T437 197Q420 196 420 217Q420 240 406 270Q377 328 284 335H260V201Q261 174 261 134Q262 73 264 61T278 38Q281 36 282 35H331Q400 35 449 50Q571 93 602 179Q605 203 622 203Q629 203 634 197T640 183Q638 181 624 95T604 3L600 -1H24Q12 5 12 16Q12 35 51 35Q92 38 97 52Q102 60 102 341T97 632Q91 645 51 648Q12 648 12 666ZM137 341Q137 131 136 89T130 37Q129 36 129 35H235Q233 41 231 48L226 61V623L231 635L235 648H129Q132 641 133 638T135 603T137 517T137 341ZM557 603V648H504Q504 646 515 639Q527 634 542 619L557 603ZM420 317V397L406 383Q394 370 380 363L366 355Q373 350 382 346Q400 333 409 328L420 317ZM582 61L586 88Q585 88 582 83Q557 61 526 46L511 37L542 35H577Q577 36 578 39T580 49T582 61Z"></path><path stroke-width="0" id="E13-MJMAIN-5B" d="M118 -250V750H255V710H158V-210H255V-250H118Z"></path><path stroke-width="0" id="E13-MJSZ1-2211" d="M61 748Q64 750 489 750H913L954 640Q965 609 976 579T993 533T999 516H979L959 517Q936 579 886 621T777 682Q724 700 655 705T436 710H319Q183 710 183 709Q186 706 348 484T511 259Q517 250 513 244L490 216Q466 188 420 134T330 27L149 -187Q149 -188 362 -188Q388 -188 436 -188T506 -189Q679 -189 778 -162T936 -43Q946 -27 959 6H999L913 -249L489 -250Q65 -250 62 -248Q56 -246 56 -239Q56 -234 118 -161Q186 -81 245 -11L428 206Q428 207 242 462L57 717L56 728Q56 744 61 748Z"></path><path stroke-width="0" id="E13-MJMATHI-69" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path><path stroke-width="0" id="E13-MJMAIN-2026" d="M78 60Q78 84 95 102T138 120Q162 120 180 104T199 61Q199 36 182 18T139 0T96 17T78 60ZM525 60Q525 84 542 102T585 120Q609 120 627 104T646 61Q646 36 629 18T586 0T543 17T525 60ZM972 60Q972 84 989 102T1032 120Q1056 120 1074 104T1093 61Q1093 36 1076 18T1033 0T990 17T972 60Z"></path><path stroke-width="0" id="E13-MJMATHI-54" d="M40 437Q21 437 21 445Q21 450 37 501T71 602L88 651Q93 669 101 677H569H659Q691 677 697 676T704 667Q704 661 687 553T668 444Q668 437 649 437Q640 437 637 437T631 442L629 445Q629 451 635 490T641 551Q641 586 628 604T573 629Q568 630 515 631Q469 631 457 630T439 622Q438 621 368 343T298 60Q298 48 386 46Q418 46 427 45T436 36Q436 31 433 22Q429 4 424 1L422 0Q419 0 415 0Q410 0 363 1T228 2Q99 2 64 0H49Q43 6 43 9T45 27Q49 40 55 46H83H94Q174 46 189 55Q190 56 191 56Q196 59 201 76T241 233Q258 301 269 344Q339 619 339 625Q339 630 310 630H279Q212 630 191 624Q146 614 121 583T67 467Q60 445 57 441T43 437H40Z"></path><path stroke-width="0" id="E13-MJMATHI-3B3" d="M31 249Q11 249 11 258Q11 275 26 304T66 365T129 418T206 441Q233 441 239 440Q287 429 318 386T371 255Q385 195 385 170Q385 166 386 166L398 193Q418 244 443 300T486 391T508 430Q510 431 524 431H537Q543 425 543 422Q543 418 522 378T463 251T391 71Q385 55 378 6T357 -100Q341 -165 330 -190T303 -216Q286 -216 286 -188Q286 -138 340 32L346 51L347 69Q348 79 348 100Q348 257 291 317Q251 355 196 355Q148 355 108 329T51 260Q49 251 47 251Q45 249 31 249Z"></path><path stroke-width="0" id="E13-MJMAIN-2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"></path><path stroke-width="0" id="E13-MJMATHI-72" d="M21 287Q22 290 23 295T28 317T38 348T53 381T73 411T99 433T132 442Q161 442 183 430T214 408T225 388Q227 382 228 382T236 389Q284 441 347 441H350Q398 441 422 400Q430 381 430 363Q430 333 417 315T391 292T366 288Q346 288 334 299T322 328Q322 376 378 392Q356 405 342 405Q286 405 239 331Q229 315 224 298T190 165Q156 25 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 114 189T154 366Q154 405 128 405Q107 405 92 377T68 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path><path stroke-width="0" id="E13-MJMAIN-5D" d="M22 710V750H159V-250H22V-210H119V710H22Z"></path><path stroke-width="0" id="E13-MJSZ2-5B" d="M224 -649V1150H455V1099H275V-598H455V-649H224Z"></path><path stroke-width="0" id="E13-MJSZ2-5D" d="M16 1099V1150H247V-649H16V-598H196V1099H16Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#E13-MJMATHI-51" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#E13-MJMATHI-3C0" x="1118" y="513"></use><g transform="translate(1462,0)"><use xlink:href="#E13-MJMAIN-28" x="0" y="0"></use><g transform="translate(389,0)"><use xlink:href="#E13-MJMATHI-73" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#E13-MJMATHI-74" x="663" y="-213"></use></g><use xlink:href="#E13-MJMAIN-2C" x="1213" y="0"></use><g transform="translate(1657,0)"><use xlink:href="#E13-MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#E13-MJMATHI-74" x="748" y="-213"></use></g><use xlink:href="#E13-MJMAIN-29" x="2542" y="0"></use></g><use xlink:href="#E13-MJMAIN-3D" x="4671" y="0"></use><g transform="translate(5727,0)"><use xlink:href="#E13-MJAMS-45" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#E13-MJMATHI-3C0" x="943" y="-213"></use></g><g transform="translate(7066,0)"><use xlink:href="#E13-MJSZ2-5B"></use><g transform="translate(472,0)"><use xlink:href="#E13-MJSZ1-2211" x="0" y="0"></use><g transform="translate(1056,-286)"><use transform="scale(0.707)" xlink:href="#E13-MJMATHI-69" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#E13-MJMAIN-3D" x="345" y="0"></use><use transform="scale(0.707)" xlink:href="#E13-MJMATHI-74" x="1123" y="0"></use><use transform="scale(0.707)" xlink:href="#E13-MJMAIN-2C" x="1484" y="0"></use><use transform="scale(0.707)" xlink:href="#E13-MJMAIN-2026" x="1762" y="0"></use><use transform="scale(0.707)" xlink:href="#E13-MJMAIN-2C" x="2934" y="0"></use><use transform="scale(0.707)" xlink:href="#E13-MJMATHI-54" x="3212" y="0"></use></g></g><g transform="translate(4563,0)"><use xlink:href="#E13-MJMATHI-3B3" x="0" y="0"></use><g transform="translate(550,362)"><use transform="scale(0.707)" xlink:href="#E13-MJMATHI-69" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#E13-MJMAIN-2212" x="345" y="0"></use><use transform="scale(0.707)" xlink:href="#E13-MJMATHI-74" x="1123" y="0"></use></g></g><g transform="translate(6263,0)"><use xlink:href="#E13-MJMATHI-72" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#E13-MJMATHI-69" x="637" y="-213"></use></g><use xlink:href="#E13-MJSZ2-5D" x="7058" y="-1"></use></g></g></svg></span><script type="math/tex">Q ^ { \pi } \left( s _ { t } , a _ { t } \right) = \mathbb { E } _ { \pi } \left[ \sum _ { i = t , \ldots , T } \gamma ^ { i - t } r _ { i } \right]</script>是策略<span class="MathJax_Preview"></span><span class="MathJax_SVG" tabindex="-1" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.331ex" height="1.34ex" viewBox="0 -486.9 573 577.1" role="img" focusable="false" style="vertical-align: -0.209ex;"><defs><path stroke-width="0" id="E14-MJMATHI-3C0" d="M132 -11Q98 -11 98 22V33L111 61Q186 219 220 334L228 358H196Q158 358 142 355T103 336Q92 329 81 318T62 297T53 285Q51 284 38 284Q19 284 19 294Q19 300 38 329T93 391T164 429Q171 431 389 431Q549 431 553 430Q573 423 573 402Q573 371 541 360Q535 358 472 358H408L405 341Q393 269 393 222Q393 170 402 129T421 65T431 37Q431 20 417 5T381 -10Q370 -10 363 -7T347 17T331 77Q330 86 330 121Q330 170 339 226T357 318T367 358H269L268 354Q268 351 249 275T206 114T175 17Q164 -11 132 -11Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#E14-MJMATHI-3C0" x="0" y="0"></use></g></svg></span><script type="math/tex">\pi</script>下的预期累积未来奖励。 从估计的最优Q函数可以容易地诱导出最优策略：如果<span class="MathJax_Preview"></span><span class="MathJax_SVG" tabindex="-1" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="26.964ex" height="3.081ex" viewBox="0 -1015.9 11609.6 1326.5" role="img" focusable="false" style="vertical-align: -0.721ex;"><defs><path stroke-width="0" id="E15-MJMATHI-61" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path><path stroke-width="0" id="E15-MJMATHI-74" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path><path stroke-width="0" id="E15-MJMAIN-3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path><path stroke-width="0" id="E15-MJMAIN-61" d="M137 305T115 305T78 320T63 359Q63 394 97 421T218 448Q291 448 336 416T396 340Q401 326 401 309T402 194V124Q402 76 407 58T428 40Q443 40 448 56T453 109V145H493V106Q492 66 490 59Q481 29 455 12T400 -6T353 12T329 54V58L327 55Q325 52 322 49T314 40T302 29T287 17T269 6T247 -2T221 -8T190 -11Q130 -11 82 20T34 107Q34 128 41 147T68 188T116 225T194 253T304 268H318V290Q318 324 312 340Q290 411 215 411Q197 411 181 410T156 406T148 403Q170 388 170 359Q170 334 154 320ZM126 106Q126 75 150 51T209 26Q247 26 276 49T315 109Q317 116 318 175Q318 233 317 233Q309 233 296 232T251 223T193 203T147 166T126 106Z"></path><path stroke-width="0" id="E15-MJMAIN-72" d="M36 46H50Q89 46 97 60V68Q97 77 97 91T98 122T98 161T98 203Q98 234 98 269T98 328L97 351Q94 370 83 376T38 385H20V408Q20 431 22 431L32 432Q42 433 60 434T96 436Q112 437 131 438T160 441T171 442H174V373Q213 441 271 441H277Q322 441 343 419T364 373Q364 352 351 337T313 322Q288 322 276 338T263 372Q263 381 265 388T270 400T273 405Q271 407 250 401Q234 393 226 386Q179 341 179 207V154Q179 141 179 127T179 101T180 81T180 66V61Q181 59 183 57T188 54T193 51T200 49T207 48T216 47T225 47T235 46T245 46H276V0H267Q249 3 140 3Q37 3 28 0H20V46H36Z"></path><path stroke-width="0" id="E15-MJMAIN-67" d="M329 409Q373 453 429 453Q459 453 472 434T485 396Q485 382 476 371T449 360Q416 360 412 390Q410 404 415 411Q415 412 416 414V415Q388 412 363 393Q355 388 355 386Q355 385 359 381T368 369T379 351T388 325T392 292Q392 230 343 187T222 143Q172 143 123 171Q112 153 112 133Q112 98 138 81Q147 75 155 75T227 73Q311 72 335 67Q396 58 431 26Q470 -13 470 -72Q470 -139 392 -175Q332 -206 250 -206Q167 -206 107 -175Q29 -140 29 -75Q29 -39 50 -15T92 18L103 24Q67 55 67 108Q67 155 96 193Q52 237 52 292Q52 355 102 398T223 442Q274 442 318 416L329 409ZM299 343Q294 371 273 387T221 404Q192 404 171 388T145 343Q142 326 142 292Q142 248 149 227T179 192Q196 182 222 182Q244 182 260 189T283 207T294 227T299 242Q302 258 302 292T299 343ZM403 -75Q403 -50 389 -34T348 -11T299 -2T245 0H218Q151 0 138 -6Q118 -15 107 -34T95 -74Q95 -84 101 -97T122 -127T170 -155T250 -167Q319 -167 361 -139T403 -75Z"></path><path stroke-width="0" id="E15-MJMAIN-6D" d="M41 46H55Q94 46 102 60V68Q102 77 102 91T102 122T103 161T103 203Q103 234 103 269T102 328V351Q99 370 88 376T43 385H25V408Q25 431 27 431L37 432Q47 433 65 434T102 436Q119 437 138 438T167 441T178 442H181V402Q181 364 182 364T187 369T199 384T218 402T247 421T285 437Q305 442 336 442Q351 442 364 440T387 434T406 426T421 417T432 406T441 395T448 384T452 374T455 366L457 361L460 365Q463 369 466 373T475 384T488 397T503 410T523 422T546 432T572 439T603 442Q729 442 740 329Q741 322 741 190V104Q741 66 743 59T754 49Q775 46 803 46H819V0H811L788 1Q764 2 737 2T699 3Q596 3 587 0H579V46H595Q656 46 656 62Q657 64 657 200Q656 335 655 343Q649 371 635 385T611 402T585 404Q540 404 506 370Q479 343 472 315T464 232V168V108Q464 78 465 68T468 55T477 49Q498 46 526 46H542V0H534L510 1Q487 2 460 2T422 3Q319 3 310 0H302V46H318Q379 46 379 62Q380 64 380 200Q379 335 378 343Q372 371 358 385T334 402T308 404Q263 404 229 370Q202 343 195 315T187 232V168V108Q187 78 188 68T191 55T200 49Q221 46 249 46H265V0H257L234 1Q210 2 183 2T145 3Q42 3 33 0H25V46H41Z"></path><path stroke-width="0" id="E15-MJMAIN-78" d="M201 0Q189 3 102 3Q26 3 17 0H11V46H25Q48 47 67 52T96 61T121 78T139 96T160 122T180 150L226 210L168 288Q159 301 149 315T133 336T122 351T113 363T107 370T100 376T94 379T88 381T80 383Q74 383 44 385H16V431H23Q59 429 126 429Q219 429 229 431H237V385Q201 381 201 369Q201 367 211 353T239 315T268 274L272 270L297 304Q329 345 329 358Q329 364 327 369T322 376T317 380T310 384L307 385H302V431H309Q324 428 408 428Q487 428 493 431H499V385H492Q443 385 411 368Q394 360 377 341T312 257L296 236L358 151Q424 61 429 57T446 50Q464 46 499 46H516V0H510H502Q494 1 482 1T457 2T432 2T414 3Q403 3 377 3T327 1L304 0H295V46H298Q309 46 320 51T331 63Q331 65 291 120L250 175Q249 174 219 133T185 88Q181 83 181 74Q181 63 188 55T206 46Q208 46 208 23V0H201Z"></path><path stroke-width="0" id="E15-MJMAIN-2208" d="M84 250Q84 372 166 450T360 539Q361 539 377 539T419 540T469 540H568Q583 532 583 520Q583 511 570 501L466 500Q355 499 329 494Q280 482 242 458T183 409T147 354T129 306T124 272V270H568Q583 262 583 250T568 230H124V228Q124 207 134 177T167 112T231 48T328 7Q355 1 466 0H570Q583 -10 583 -20Q583 -32 568 -40H471Q464 -40 446 -40T417 -41Q262 -41 172 45Q84 127 84 250Z"></path><path stroke-width="0" id="E15-MJCAL-41" d="M576 668Q576 688 606 708T660 728Q676 728 675 712V571Q675 409 688 252Q696 122 720 57Q722 53 723 50T728 46T732 43T737 41T743 39L754 45Q788 61 803 61Q819 61 819 47Q818 43 814 35Q799 15 755 -7T675 -30Q659 -30 648 -25T630 -8T621 11T614 34Q603 77 599 106T594 146T591 160V163H460L329 164L316 145Q241 35 196 -7T119 -50T59 -24T30 43Q30 75 46 100T74 125Q81 125 83 120T88 104T96 84Q118 57 151 57Q189 57 277 182Q432 400 542 625L559 659H567Q574 659 575 660T576 668ZM584 249Q579 333 577 386T575 473T574 520V581L563 560Q497 426 412 290L372 228L370 224H371L383 228L393 232H586L584 249Z"></path><path stroke-width="0" id="E15-MJMATHI-51" d="M399 -80Q399 -47 400 -30T402 -11V-7L387 -11Q341 -22 303 -22Q208 -22 138 35T51 201Q50 209 50 244Q50 346 98 438T227 601Q351 704 476 704Q514 704 524 703Q621 689 680 617T740 435Q740 255 592 107Q529 47 461 16L444 8V3Q444 2 449 -24T470 -66T516 -82Q551 -82 583 -60T625 -3Q631 11 638 11Q647 11 649 2Q649 -6 639 -34T611 -100T557 -165T481 -194Q399 -194 399 -87V-80ZM636 468Q636 523 621 564T580 625T530 655T477 665Q429 665 379 640Q277 591 215 464T153 216Q153 110 207 59Q231 38 236 38V46Q236 86 269 120T347 155Q372 155 390 144T417 114T429 82T435 55L448 64Q512 108 557 185T619 334T636 468ZM314 18Q362 18 404 39L403 49Q399 104 366 115Q354 117 347 117Q344 117 341 117T337 118Q317 118 296 98T274 52Q274 18 314 18Z"></path><path stroke-width="0" id="E15-MJMAIN-5E" d="M112 560L249 694L257 686Q387 562 387 560L361 531Q359 532 303 581L250 627L195 580Q182 569 169 557T148 538L140 532Q138 530 125 546L112 560Z"></path><path stroke-width="0" id="E15-MJMAIN-28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path><path stroke-width="0" id="E15-MJMATHI-73" d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z"></path><path stroke-width="0" id="E15-MJMAIN-2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path><path stroke-width="0" id="E15-MJMAIN-7C" d="M139 -249H137Q125 -249 119 -235V251L120 737Q130 750 139 750Q152 750 159 735V-235Q151 -249 141 -249H139Z"></path><path stroke-width="0" id="E15-MJMATHI-3B8" d="M35 200Q35 302 74 415T180 610T319 704Q320 704 327 704T339 705Q393 701 423 656Q462 596 462 495Q462 380 417 261T302 66T168 -10H161Q125 -10 99 10T60 63T41 130T35 200ZM383 566Q383 668 330 668Q294 668 260 623T204 521T170 421T157 371Q206 370 254 370L351 371Q352 372 359 404T375 484T383 566ZM113 132Q113 26 166 26Q181 26 198 36T239 74T287 161T335 307L340 324H145Q145 321 136 286T120 208T113 132Z"></path><path stroke-width="0" id="E15-MJMAIN-29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#E15-MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#E15-MJMATHI-74" x="748" y="-213"></use><use xlink:href="#E15-MJMAIN-3D" x="1162" y="0"></use><g transform="translate(2217,0)"><use xlink:href="#E15-MJMAIN-61"></use><use xlink:href="#E15-MJMAIN-72" x="500" y="0"></use><use xlink:href="#E15-MJMAIN-67" x="892" y="0"></use></g><g transform="translate(3776,0)"><use xlink:href="#E15-MJMAIN-6D"></use><use xlink:href="#E15-MJMAIN-61" x="833" y="0"></use><use xlink:href="#E15-MJMAIN-78" x="1333" y="0"></use><g transform="translate(1861,-171)"><use transform="scale(0.707)" xlink:href="#E15-MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#E15-MJMAIN-2208" x="529" y="0"></use><use transform="scale(0.707)" xlink:href="#E15-MJCAL-41" x="1196" y="0"></use></g></g><g transform="translate(7328,0)"><use xlink:href="#E15-MJMATHI-51" x="0" y="0"></use><use xlink:href="#E15-MJMAIN-5E" x="228" y="239"></use></g><g transform="translate(8286,0)"><use xlink:href="#E15-MJMAIN-28" x="0" y="0"></use><g transform="translate(389,0)"><use xlink:href="#E15-MJMATHI-73" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#E15-MJMATHI-74" x="663" y="-213"></use></g><use xlink:href="#E15-MJMAIN-2C" x="1213" y="0"></use><use xlink:href="#E15-MJMATHI-61" x="1657" y="0"></use><use xlink:href="#E15-MJMAIN-7C" x="2186" y="0"></use><use xlink:href="#E15-MJMATHI-3B8" x="2464" y="0"></use><use xlink:href="#E15-MJMAIN-29" x="2933" y="0"></use></g></g></svg></span><script type="math/tex">a _ { t } = \arg \max _ { a \in \mathcal { A } } \hat { Q } \left( s _ { t } , a | \theta \right)</script>，则<span class="MathJax_Preview"></span><span class="MathJax_SVG" tabindex="-1" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="14.204ex" height="2.671ex" viewBox="0 -839.6 6115.8 1150.2" role="img" focusable="false" style="vertical-align: -0.721ex;"><defs><path stroke-width="0" id="E16-MJMATHI-3C0" d="M132 -11Q98 -11 98 22V33L111 61Q186 219 220 334L228 358H196Q158 358 142 355T103 336Q92 329 81 318T62 297T53 285Q51 284 38 284Q19 284 19 294Q19 300 38 329T93 391T164 429Q171 431 389 431Q549 431 553 430Q573 423 573 402Q573 371 541 360Q535 358 472 358H408L405 341Q393 269 393 222Q393 170 402 129T421 65T431 37Q431 20 417 5T381 -10Q370 -10 363 -7T347 17T331 77Q330 86 330 121Q330 170 339 226T357 318T367 358H269L268 354Q268 351 249 275T206 114T175 17Q164 -11 132 -11Z"></path><path stroke-width="0" id="E16-MJMAIN-28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path><path stroke-width="0" id="E16-MJMATHI-61" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path><path stroke-width="0" id="E16-MJMATHI-74" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path><path stroke-width="0" id="E16-MJMAIN-7C" d="M139 -249H137Q125 -249 119 -235V251L120 737Q130 750 139 750Q152 750 159 735V-235Q151 -249 141 -249H139Z"></path><path stroke-width="0" id="E16-MJMATHI-73" d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z"></path><path stroke-width="0" id="E16-MJMAIN-29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path><path stroke-width="0" id="E16-MJMAIN-3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path><path stroke-width="0" id="E16-MJMAIN-31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path><path stroke-width="0" id="E16-MJMAIN-2E" d="M78 60Q78 84 95 102T138 120Q162 120 180 104T199 61Q199 36 182 18T139 0T96 17T78 60Z"></path><path stroke-width="0" id="E16-MJMAIN-30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#E16-MJMATHI-3C0" x="0" y="0"></use><g transform="translate(739,0)"><use xlink:href="#E16-MJMAIN-28" x="0" y="0"></use><g transform="translate(389,0)"><use xlink:href="#E16-MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#E16-MJMATHI-74" x="748" y="-213"></use></g><use xlink:href="#E16-MJMAIN-7C" x="1273" y="0"></use><g transform="translate(1551,0)"><use xlink:href="#E16-MJMATHI-73" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#E16-MJMATHI-74" x="663" y="-213"></use></g><use xlink:href="#E16-MJMAIN-29" x="2375" y="0"></use></g><use xlink:href="#E16-MJMAIN-3D" x="3781" y="0"></use><g transform="translate(4837,0)"><use xlink:href="#E16-MJMAIN-31"></use><use xlink:href="#E16-MJMAIN-2E" x="500" y="0"></use><use xlink:href="#E16-MJMAIN-30" x="778" y="0"></use></g></g></svg></span><script type="math/tex">\pi \left( a _ { t } | s _ { t } \right) = 1.0</script>，否则<span class="MathJax_Preview"></span><span class="MathJax_SVG" tabindex="-1" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="12.397ex" height="2.671ex" viewBox="0 -839.6 5337.8 1150.2" role="img" focusable="false" style="vertical-align: -0.721ex;"><defs><path stroke-width="0" id="E17-MJMATHI-3C0" d="M132 -11Q98 -11 98 22V33L111 61Q186 219 220 334L228 358H196Q158 358 142 355T103 336Q92 329 81 318T62 297T53 285Q51 284 38 284Q19 284 19 294Q19 300 38 329T93 391T164 429Q171 431 389 431Q549 431 553 430Q573 423 573 402Q573 371 541 360Q535 358 472 358H408L405 341Q393 269 393 222Q393 170 402 129T421 65T431 37Q431 20 417 5T381 -10Q370 -10 363 -7T347 17T331 77Q330 86 330 121Q330 170 339 226T357 318T367 358H269L268 354Q268 351 249 275T206 114T175 17Q164 -11 132 -11Z"></path><path stroke-width="0" id="E17-MJMAIN-28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path><path stroke-width="0" id="E17-MJMATHI-61" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path><path stroke-width="0" id="E17-MJMATHI-74" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path><path stroke-width="0" id="E17-MJMAIN-7C" d="M139 -249H137Q125 -249 119 -235V251L120 737Q130 750 139 750Q152 750 159 735V-235Q151 -249 141 -249H139Z"></path><path stroke-width="0" id="E17-MJMATHI-73" d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z"></path><path stroke-width="0" id="E17-MJMAIN-29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path><path stroke-width="0" id="E17-MJMAIN-3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path><path stroke-width="0" id="E17-MJMAIN-30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#E17-MJMATHI-3C0" x="0" y="0"></use><g transform="translate(739,0)"><use xlink:href="#E17-MJMAIN-28" x="0" y="0"></use><g transform="translate(389,0)"><use xlink:href="#E17-MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#E17-MJMATHI-74" x="748" y="-213"></use></g><use xlink:href="#E17-MJMAIN-7C" x="1273" y="0"></use><g transform="translate(1551,0)"><use xlink:href="#E17-MJMATHI-73" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#E17-MJMATHI-74" x="663" y="-213"></use></g><use xlink:href="#E17-MJMAIN-29" x="2375" y="0"></use></g><use xlink:href="#E17-MJMAIN-3D" x="3781" y="0"></use><use xlink:href="#E17-MJMAIN-30" x="4837" y="0"></use></g></svg></span><script type="math/tex">\pi \left( a _ { t } | s _ { t } \right) = 0</script>。 利用重放存储器、目标网络、双网络和决斗架构等技术来减少样本相关性，最大化偏差，更新目标不一致性和更新目标方差。 这些技术提高了学习稳定性和样本效率。 由于奖励的稀疏性和长时间延迟，我们使用混合蒙特卡洛（MMC）回归和增强Q学习回归作为Q更新目标，这加速了奖励传播并稳定了训练。</p><h5><a name='header-n1643' class='md-header-anchor '></a>近端策略优化（PPO）</h5><p>我们还通过使用近端策略优化（PPO）直接学习随机策略<span class="MathJax_Preview"></span><span class="MathJax_SVG" tabindex="-1" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="10.261ex" height="2.671ex" viewBox="0 -839.6 4417.9 1150.2" role="img" focusable="false" style="vertical-align: -0.721ex;"><defs><path stroke-width="0" id="E18-MJMATHI-3C0" d="M132 -11Q98 -11 98 22V33L111 61Q186 219 220 334L228 358H196Q158 358 142 355T103 336Q92 329 81 318T62 297T53 285Q51 284 38 284Q19 284 19 294Q19 300 38 329T93 391T164 429Q171 431 389 431Q549 431 553 430Q573 423 573 402Q573 371 541 360Q535 358 472 358H408L405 341Q393 269 393 222Q393 170 402 129T421 65T431 37Q431 20 417 5T381 -10Q370 -10 363 -7T347 17T331 77Q330 86 330 121Q330 170 339 226T357 318T367 358H269L268 354Q268 351 249 275T206 114T175 17Q164 -11 132 -11Z"></path><path stroke-width="0" id="E18-MJMAIN-28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path><path stroke-width="0" id="E18-MJMATHI-73" d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z"></path><path stroke-width="0" id="E18-MJMATHI-74" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path><path stroke-width="0" id="E18-MJMAIN-2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path><path stroke-width="0" id="E18-MJMATHI-61" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path><path stroke-width="0" id="E18-MJMAIN-7C" d="M139 -249H137Q125 -249 119 -235V251L120 737Q130 750 139 750Q152 750 159 735V-235Q151 -249 141 -249H139Z"></path><path stroke-width="0" id="E18-MJMATHI-3B8" d="M35 200Q35 302 74 415T180 610T319 704Q320 704 327 704T339 705Q393 701 423 656Q462 596 462 495Q462 380 417 261T302 66T168 -10H161Q125 -10 99 10T60 63T41 130T35 200ZM383 566Q383 668 330 668Q294 668 260 623T204 521T170 421T157 371Q206 370 254 370L351 371Q352 372 359 404T375 484T383 566ZM113 132Q113 26 166 26Q181 26 198 36T239 74T287 161T335 307L340 324H145Q145 321 136 286T120 208T113 132Z"></path><path stroke-width="0" id="E18-MJMAIN-29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#E18-MJMATHI-3C0" x="0" y="0"></use><g transform="translate(739,0)"><use xlink:href="#E18-MJMAIN-28" x="0" y="0"></use><g transform="translate(389,0)"><use xlink:href="#E18-MJMATHI-73" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#E18-MJMATHI-74" x="663" y="-213"></use></g><use xlink:href="#E18-MJMAIN-2C" x="1213" y="0"></use><g transform="translate(1657,0)"><use xlink:href="#E18-MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#E18-MJMATHI-74" x="748" y="-213"></use></g><use xlink:href="#E18-MJMAIN-7C" x="2542" y="0"></use><use xlink:href="#E18-MJMATHI-3B8" x="2820" y="0"></use><use xlink:href="#E18-MJMAIN-29" x="3289" y="0"></use></g></g></svg></span><script type="math/tex">\pi \left( s _ { t } , a _ { t } | \theta \right)</script>的参数形式进行了实验。 PPO是一种样本有效的策略梯度方法，利用策略比率信任区域裁剪来避免解决TRPO中KL散度约束保守策略迭代问题所需的复共轭梯度优化。 我们使用截断形式的广义优势估计来权衡优势估计的偏差和方差。 第3.2.1节中描述的可用操作列表用于屏蔽不可用的操作，并在每个步骤中对操作的概率分布进行重新规范化。</p><h5><a name='header-n1645' class='md-header-anchor '></a>神经网络架构</h5><p>我们采用多层感知神经网络来参数化状态-动作值函数、状态值函数和策略函数。 虽然可以考虑更复杂的网络架构（例如，提取空间特征的卷积层，或补偿部分观察的循环层），但我们将把它们留给将来的工作。</p><h5><a name='header-n1647' class='md-header-anchor '></a>分布式部署基础架构</h5><p>SC2游戏核心是CPU密集型的，并且运行速度缓慢，导致RL训练期间出现瓶颈。 为了缓解这个问题，我们构建了一个分布式部署基础架构，其中利用一组CPU机器（称为actor）并行执行部署过程。 缓存在每个actor的重放内存中的运行经验被随机采样并定期发送到基于GPU的机器（称为学习者）。 我们目前采用1920个并行演员（80个机器上有3840个CPU）来生成重播过渡，速度约为每秒16,000帧。 这显着缩短了训练时间（从数周到数天），并且由于探索轨迹的多样性增加，也提高了学习稳定性。</p><h3><a name='header-n1649' class='md-header-anchor '></a>3.3 TStarBot2：基于分层宏 - 微动作的代理</h3><p>第3.2节中描述的基于宏动作的代理有一些限制。尽管宏操作可以根据功能进行分组，但是单个控制器必须处理所有操作组，其中不同组的操作在每个决策步骤中是互斥的。此外，在预测要采取的操作时，控制器会采取不知道操作组的常见观察。这相当于训练控制器的不必要的困难，因为不期望的信息可能会引起观察和动作。此外，宏观行动对单个单位（即，每单位控制）没有任何控制，当我们想要采用多代理方式时，这是不灵活的。</p><p>为了提高灵活性，我们创建了一组不同的操作，如图3所示。我们采用宏操作和微操作，以双层结构组织。上层对应宏观行动，代表高级战略/战术，如“在我们的主要基地附近建造RoachWarren”或“小队攻击敌人基地”，而较低层对应于微动作，其对应于每个单元上的低级控制，例如“单元25在特定位置建立RoachWarren”或“单元42攻击到特定位置”。整个动作集分为水平和垂直组。为每个操作组分配一个单独的控制器，该控制器只能看到与其中的操作相关的本地操作和本地观察。在每个时间步骤，同一层的控制器可以同时采取行动，而下游控制器必须以其上游控制器为条件。</p><p><img src='pic/tencent-f3.png' alt='' referrerPolicy='no-referrer' /></p><p>图3：宏 - 微层次动作概述。 请参阅正文以获得解释。</p><p>这种层次结构有两个优点。</p><ol start='' ><li>每个控制器都有自己的观察/行动空间，以便更容易过滤掉无关信息。在对子任务Q头进行建模时，[32]也采用并讨论了这一点。 </li><li>层次结构更好地捕获游戏的动作结构，同时来自不同控制器的动作。</li></ol><p>虽然理想情况下控制器应该单独或联合训练RL，但在这项工作中，我们只是采用专家规则，目的是验证提出的分层动作集方法。</p><p>如图4所示，每个控制器代表一个模块，以类似于UAlbertaBot的方式组织。 第一层模块（CombatStrategy、ProductionStrategy）仅发出高级命令（宏操作），而第二层模块（Combat、Scout、Resource和Building）发出低级命令（微操作）。 所有这些模块都嵌入到DataContext中，每个模块可以通过发送/接收消息和共享自定义数据结构与其他模块进行通信。 至关重要的是，PySC2公开的游戏玩法观察被放置在DataContext中，从此对每个模块都是可见的。 这样，每个模块可以从共同观察中提取与其自己的动作集相关的局部观察。 在下文中，我们将更详细地描述模块。</p><p><img src='pic/tencent-f4.png' alt='' referrerPolicy='no-referrer' /></p><p>图4：基于宏-微分层操作的代理的模块图。 请参阅正文以获得解释。</p><h4><a name='header-n1664' class='md-header-anchor '></a>3.3.1 数据背景</h4><p>DataContext模块用作模块交换信息的“黑板”。 DataContext中包含的内容属于以下类别。</p><ol start='' ><li>观察。 PySC2提供的特征映射以及当前时间步骤中所有活动单元的单元数据结构都被暴露出来。</li><li>池。 池是特定类型单元的数组，具有用于轻松访问调用程序模块的关联属性/方法。 例如，WorkerPool是所有ZergDrone的数组。 作为另一个例子，BasePool是所有Zerg基础的数组，池中的每个项目都是BaseInstance。 BaseInstance是一个定制的数据结构，记录Base（可以是Hatchery / Hive / Lair），Base的固定范围内的相关Drone、矿物和提取器、以及矿物的几何布局给出的局部坐标系。</li><li>命令队列。 高级命令存储在对所有（较低层）模块可见的队列中。 例如，ProductionStrategy模块发出的命令在BuildCommand中被推送。 高级命令可以是“更新特定技术”或“目前收获更多矿物”。 较低层模块（在这种情况下分别为Building和Resource）将从队列中提取它识别的命令并通过采用相应的规则来执行它以产生游戏核心可接受的动作。</li></ol><p>在每个时间步，DataContext将更新Observations和各种池，而命令队列将被其他模块修改或访问。</p><h4><a name='header-n1674' class='md-header-anchor '></a>3.3.2 战斗策略</h4><p>战斗策略模块做出高级决策，以便代理可以以不同方式对抗敌人。 该模块通过将他们组织成小队和军队来操纵所有战斗单位。 每个小队可能包含一个或多个作战单位，预计将执行一项特定任务，例如骚扰敌人基地、清理地图中的岩石等。通常，一小组具有相同单位类型的作战单位组织成一个小队。 一支军队包含多个具有高级战略目标的小队，例如攻击敌人、防御基地等，然后将特定命令发送给军队中的每个小队。 然后将每个命令与小队 - 命令对相结合，推入战斗策略命令队列（在数据上下文中维护），该队列将由战斗模块接收和执行。</p><p>我们的实施包括五个高级战斗策略：</p><ul><li>冲击：一旦少数战斗部队建立起来，发动攻击并继续派遣小队攻击敌人基地。</li><li>经济第一：首先收集矿物和气体，然后在积累了大量小队后发动攻击。</li><li>时间攻击：尽快建立一支强大的Roach和Hydralisk队，并发起强大的攻击。</li><li>重组：对敌人基地进行分类，让军队以最优先的方式攻击最近的敌人基地。 当接近目标敌人基地时，停止领导小队并让他们等待其他小队聚集。 然后，发动攻击。</li><li>哈拉斯：将地面作战部队的作战策略定为“重组”。 建立2-3个Mutalisk小队并为每个小队分配一个目标敌人基地。 然后，让Mutalisk绕道并骚扰目标敌人基地的Drone。</li></ul><h4><a name='header-n1688' class='md-header-anchor '></a>3.3.3 战斗</h4><p>作战模块从命令队列中获取命令并为每个单元执行特定操作。 它使用单位级操纵来有效地让每个单位与敌人作战。 战斗模块实现了一些基本的人类微观管理策略，例如肇事逃逸、掩护攻击等，可以部署到所有作战单位类型。 具体而言，通过充分利用单位类型特定技能，实现每个特定作战单位的附加微管理经理。 例如，Roach的微型管理使Roach能够挖掘并逃离敌人，以便在他们虚弱时恢复。飞龙被编码为悄悄地到达敌人基地并骚扰敌人的经济，潜伏者使用精心设计的肇事逃逸战术结合挖洞和向上挖掘，皇后可以提供额外的Larvas和治愈弱盟友等。这些微观管理被组织成层次结构，每个部分可以方便地用RL模型替换。</p><h4><a name='header-n1690' class='md-header-anchor '></a>3.3.4 生产战略</h4><p>生产战略模块管理建筑/单元生产、技术升级和资源收集。 该模块通过向每个BaseInstance发送生产指令来控制单元和建筑物的生产。 技术升级指令和其他特定指令，例如Zerg的Morph，被精确地推送到目标单元。 然后，Building模块将实现上述所有生产指令。 资源收集命令是高度抽象的，生产策略只需根据矿物/天然气储存比确定优先级。 然后，Resource模块将根据优先级指令将worker重新分配给每个BaseInstance。</p><p>在该模块中，我们维护一个建筑订单队列，用于短期生产计划。 大多数时候，只要有足够的资源并满足先决条件，管理就会按照订单生产物品（单位、建筑物或技术人员）。 在某些特殊情况下（例如，扩展新基地）或在紧急情况下（例如，找到隐藏的敌方单位），可以将更优先的项目放在队列前面，或者我们甚至可以在新目标时清除整个队列。 当队列为空（包括在游戏开始时）时，应立即设置新的短期目标。</p><p>在每个时间步执行实际生产时，将根据TechTree检查当前项的先决条件和资源要求。 如果需要，高级项目的先决条件将自动添加到队列中，如果不满足资源要求，将跳过当前时间步骤。 此外，当准备生成当前项目时，将选择BaseInstance，通知项目类型，并分配执行具体生产。</p><p>通过使用不同的开放顺序和目标规划功能，我们为Zerg定义了两种不同的生产策略，如下所示。</p><ul><li>RUSH：“Roach冲刺”。 它在开始时产生Roach，并升级技术BURROW和TUNNELINGCLAWS以使蟑螂能够在挖洞时挖洞和移动，并在挖洞时提高健康再生率。 该战略不断产生Roach和口水龙。</li><li>DEF_AND_ADV：“保卫和先进的军队”。 这种策略在第二垒产生了许多SPINECRAWLER来防御，然后逐渐产生先进的军队。 几乎包括所有类型的战斗单位，并且根据预定义的字典限制类型之间的最终比率。</li></ul><h4><a name='header-n1700' class='md-header-anchor '></a>3.3.5 建造</h4><p>构建模块接收并执行生产策略发布的高级命令，如第3.3.4节所述。 “一元”命令（即，让一些单元单独行动）直接执行。 一些“二进制”命令需要更多解释。</p><p>命令“展开”将从指定的基础拖动Drone，将其发送到指定的“资源区域”，并开始变形孵化器，当第一个获取地图信息时，通过启发式方法预先计算其全局坐标。</p><p>命令“Building”将拖动Drone，将其变形到某个位置的指定建筑物，其坐标由称为Placer的专用子模块决定。在我们的实施中，我们采用混合方法来建立放置，即，一些核心建筑物被放置在预定位置，而其他建筑物被随机放置。这两种类型的位置都位于BaseInstance局部坐标系中，并且当它们被转换为游戏核心可接受的动作时将被转换为全局坐标系。具体而言，所有技术升级相关建筑和前六个SpineCrawler都是预先定义的。请注意，六个SpineCrawlers位置的布局是至关重要的（例如，它们是钻石形成还是矩形形式），影响防御质量以及我们是否能够在对手玩家的早期冲击中幸存下来。我们已经尝试了几种安排，并决定钻石的形成。其他建筑物，包括额外的SpineCrawlers，将被随机放置，其中重复生成均匀随机坐标，直到它通过所有有效性检查（例如，是否在Zerg蠕变，是否与其他建筑物重叠等）。</p><h4><a name='header-n1704' class='md-header-anchor '></a>3.3.6 资源</h4><p>资源模块是通过将Drone送到矿物碎片或提取器来收集矿物质和气体。 在每个时间步，该模块需要知道当前的工作模式是“矿物优先”还是“先燃气”，这是一个高级命令，称为生产策略模块发布的“资源类型优先级”。 该模块的目标是最大化资源收集速度，这可能是一个复杂的控制问题。 在我们的实施中，我们采用了几个规则来实现这一目标，结果证明是简单而有效的。 根本的想法是让每个Drone工作，避免任何Drone闲置。 具体而言，我们让以下规则在每个时间步骤顺序执行。</p><ol start='' ><li>基地内规则。 在每个时间步骤，根据“资源类型优先级”命令，将重新平衡与BaseInstance相关联的本地Drone以收集更多矿物或更多气体。 请注意，对于每个基础和提取器，SC2游戏核心维护两个有用的变量“理想收割机编号”，即建议的最大Drone数量，以及“指定收集器编号”，即实际使用的Drone编号。 使用这两个变量，很容易确定矿物和气体的当地工作Drone是否填充不足或过度填充。</li><li>基地间规则。 当一个新的分支基地即将完成时，将3个Drone从其他基地拖入新基地。 这通过节省一些等待时间来提高资源收集效率。 我们发现这个技巧很重要，特别是在扩展第一个分支基础时。</li><li>全局规则。 它扫描可能的闲置工人。 根据当前的工作模式“资源类型优先级”，每个闲置工人被送到最近的基地以收获矿物或天然气。 请注意，当矿物质或提取器耗尽且所有在其上工作的当地Drone都处于闲置状态时，规则还要确保将这些闲置工人送到附近的基地。</li></ol><h4><a name='header-n1713' class='md-header-anchor '></a>3.3.7 侦察</h4><p>Scout模块试图找出尽可能多的敌方单位。 启用雾化模式后，每个单元只有一个非常狭窄的视图。 因此，许多敌方单位是看不见的，除非玩家自己的单位可以接近他们并通过侦察看到他们。</p><p>在我们的实施中，我们发送ZergDrone或宿主来探测敌方单位并将发现的单位存储在EnemyPool中，从中我们可以推断出高级信息，例如敌人主基地或分支基地的位置，敌人目前的建筑物， 这种信息可以进一步用于推断敌人的策略，对战斗策略或生产战略有用，可以相应地制定反策略。</p><p>我们定义了以下侦察任务。</p><ol start='' ><li>探索任务。 每当有一个新的霸王，我们就把它送到一个矿区。 这一行动试图查看敌人的领土，以推断其经济。 当被攻击时，霸王将撤退; 否则它只会停留在目标位置。</li><li>强迫任务。 我们将一架Drone送到敌人的第一个分支基地。 通过这样做，我们可以找到有用的信息（例如，许多敌人的小狗是否已经团结起来，这发生在敌人即将在游戏的早期阶段执行RUSH策略时）。</li></ol><p>每项任务的激活取决于游戏的进度和时间步长。</p><h2><a name='header-n1723' class='md-header-anchor '></a>4. 实验</h2><p>报告了分别在3.2节和3.3节中描述的两种代理的实验结果。 我们在1v1 Zerg-vs-Zerg完整游戏中测试了该代理。 具体来说，代理对抗内置AI，范围从1级（最简单）到10级（最难）。 我们使用的地图是AbyssalReef6，在其上报告了原始PySC2观察/行动的香草A3C代理，尽管在Terran-vs-Terran完整游戏中与内置AI进行比赛时表现不佳。</p><h3><a name='header-n1725' class='md-header-anchor '></a>4.1 TStarBot1</h3><p>建议的基于宏观动作的代理TStarBot1（第3.2节）通过对各种难度级别的内置AI的混合进行训练进行训练：对于每个首次展示，从1级、2级随机均匀地采样难度级别， 4,6,9,10为对手内置AI。 我们限制TStarBot1每32帧（即大约每2秒）采取一次宏动作，这将时间范围缩短到每场约300~1200步并将TStarBot1的APM（每分钟动作数）减少到大约400~800，这更多与人类玩家相当。 在这些初步实验中，我们仅将非空间特征与简单的MLP神经网络结合使用。 此外，为了加速学习，我们修剪战斗宏动作，我们只使用ZoneJ-Attack-ZoneJ、ZoneI-Attack-ZoneD、ZoneD-Attack-ZoneA。</p><p>表2报告了TStarBot1代理对内置AI的获胜率从1级到10级。每个报告的获胜率是通过采用具有不同随机种子的200个游戏的平均值获得的，其中计算时的平局计为0.5 赢率。 使用单个GPU和3840个CPU进行约1~2天的训练后，强化学习代理（DDQN和PPO）可以在从1级到9级的所有内置机器人中赢得超过90％的游戏，并且 超过70％对抗10级。 训练和评估都是在启用战争迷雾（没有作弊）的情况下进行的。</p><p><img src='pic/tencent-t2.png' alt='' referrerPolicy='no-referrer' /></p><p>表2：TStarBot1和TStarBot2代理的胜率（％），针对各种难度级别的内置AI。 对于TStarBot1，报告了DDQN，PPO和随机策略的结果。 通过使用具有不同随机种子的200个游戏的平均值来获得每个获胜率，其中启用了Fog-of-war。</p><p>图5显示了使用PPO算法的TStarBot1的学习进度。曲线显示了在训练期间看到的帧数增加，胜率如何增加。每条曲线对应于某个难度级别的内置AI。请注意，TStarBot1开始在大约30M帧（大约0.06M游戏）中击败（至少75％的赢率）Easy（2级）内置AI，Hard（4级）约250M帧（约0.5M），VeryHard（6级）约800M帧（约1.6M游戏），CheatResources（9级）约2000M（约4M游戏），CheatInsane（10级）约3500M帧（约7M游戏） 。</p><p><img src='pic/tencent-f5.png' alt='' referrerPolicy='no-referrer' /></p><p>图5：使用PPO算法的TStarBot1的学习曲线。 请注意，TStarBot1-PPO在大约30M帧时开始失败（至少75％的赢率）Easy（Level-2）内置AI，大约250M帧的Hard（Level-4），大约800M帧的VeryHard（Level-6），大约2000M的CheatResources（Level-9），以及CheatInsane（Level-10）约3500M帧。</p><p>经过探索和学习，代理似乎获得了一些类似人类玩家使用的有趣策略。我们展示了关于它学习的战斗时间（即何时触发攻击）的两种策略，如图6所示：即使只有少量战斗单位可用，也会尽快触发攻击。经济第一，只有在组建了强大的军队之后才能继续发展经济并发动第一次袭击。此外，我们还观察到TStarBot1倾向于建立3~4个基地以促进经济增长，并且在规划攻击路线时更倾向于横向。</p><h3><a name='header-n1734' class='md-header-anchor '></a>4.2 TStarBot2</h3><p>表2显示了采用分层宏 - 微动作和基于规则的控制器的代理的获胜率，如第3.3节所述。 每个报告的赢率是通过采用具有不同随机种子的100个游戏的平均值获得的，其中在计算赢率时将平局计为0.5。 在测试期间启用了战争迷雾。 我们可以看到，代理能够始终如一地击败所有级别的内置AI，显示分层动作建模的有效性。</p><h3><a name='header-n1736' class='md-header-anchor '></a>4.3 TStarBots与人类玩家</h3><p>在非正式的内部测试中，我们让TStarBot1或TStarBot2在SC2 Battle.net League的排名系统中对抗从Platinum到Diamond级别的几个人类玩家。 该设置保持与上述子部分相同，即地图AbyssalReef上的Zerg-vs-Zerg完整游戏，启用了战争雾。 结果报告在表3中。我们可以看到TStarBot1和TStarBot2都可能击败白金（甚至是钻石）人类玩家。</p><p><img src='pic/tencent-t3.png' alt='' referrerPolicy='no-referrer' /></p><p>表3：TStarBots与人类玩家。 每个条目都意味着TStarBot1 / TStarBot2获胜和输掉了多少场比赛。 例如，1/2意味着TStarBot“赢得1场比赛并输掉2场比赛”。</p><h3><a name='header-n1740' class='md-header-anchor '></a>4.4 TStarBot1对抗TStarBot2</h3><p>在另一场非正式测试中，我们让两个TStarBots相互对抗。我们观察到TStarBot1总能打败TStarBot2。检查游戏玩法，我们发现TStarBot1倾向于使用Zergling Rush策略，而TStarBot2缺乏反冲刺战略，从此总是失败。</p><p>值得注意的是，虽然TStarBot1可以成功学习并获得战胜所有内置AI和TStarBot2的策略，但它缺乏战略多样性以不断击败人类玩家。在上述与人类玩家的测试中，一旦人类玩家发现TStarBot1对Zergling Rush的偏好，TStarBot1将会一直失败。战略多样性不足可能是由以下原因引起的。 </p><ol start='' ><li>缺乏对手的多样性。尽管内置AI已经配备了多种预先定义的策略，但与人类玩家相比，他们的策略受到的限制要大得多。</li><li>缺乏深入的探索。先进单位的生产被深埋在技术树中，这对于简单的探索方法（如epsilon-greedy）来说是困难且低效的。</li></ol><p>自我训练和随机化技术是缓解这些问题的有希望的方法，我们将留待将来的工作。</p><h2><a name='header-n1749' class='md-header-anchor '></a>5. 结论</h2><p>对于SC2LE，我们通过手动调整规则对结构动作空间进行建模，从而将大量原子动作减少为少量可以对机器学习进行处理的宏动作。 我们研究了两个代理：一个代理TStarBot1，基于具有强化学习控制器的平面动作建模，可以实现对内置AI的相当高的赢率。 另一个代理TStarBot2采用分层动作建模和基于规则的控制器，可以持续赢得内置AI。 这项工作表明，这种动作空间建模方法可以与传统的RL算法一起使用，因此RL算法可以为SC2 1v1完整游戏学习一个好的策略。 将来，探索统一的方法将是有益的，其中可以针对每个组件联合或单独地优化层级。</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p></div>
</body>
</html>